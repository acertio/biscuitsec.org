(this.webpackJsonpbiscuitsec=this.webpackJsonpbiscuitsec||[]).push([[1],{183:function(e,a,t){e.exports=t(284)},188:function(e,a,t){},189:function(e,a,t){},190:function(e,a,t){e.exports=t.p+"static/media/biscuitsec_logo5.4d30928f.svg"},279:function(e,a,t){e.exports=t.p+"static/media/biscuitsec_logo.b271c757.svg"},280:function(e,a,t){e.exports=t.p+"static/media/biscuitsec.82680035.svg"},284:function(e,a,t){"use strict";t.r(a);var r=t(0),n=t.n(r),c=t(35),l=t.n(c),i=(t(188),t(11)),s=t(12),o=t(14),m=t(13),d=(t(25),t(189),t(21)),_=t(44),u=t(20),v=function(e){Object(o.a)(r,e);var a=Object(m.a)(r);function r(e){var t;return Object(i.a)(this,r),(t=a.call(this,e)).toggleNavbar=t.toggleNavbar.bind(Object(_.a)(t)),t.state={collapsed:!0},t}return Object(s.a)(r,[{key:"toggleNavbar",value:function(){this.setState({collapsed:!this.state.collapsed})}},{key:"render",value:function(){var e=this.state.collapsed,a=e?"collapse navbar-collapse":"collapse navbar-collapse show",r=e?"navbar-toggler navbar-toggler-right collapsed":"navbar-toggler navbar-toggler-right",c=e?{textAlign:"right"}:{textAlign:"left"};return n.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-dark fixed-top"},n.a.createElement("a",{"aria-current":"page",className:"navbar navbar-light  active",href:"/"},n.a.createElement("img",{className:"navbar_logo img-fluid",src:t(190),alt:"open.acert.io"})),n.a.createElement("button",{onClick:this.toggleNavbar,className:"".concat(r),type:"button","data-toggle":"collapse","data-target":"#navbarResponsive","aria-controls":"navbarResponsive","aria-expanded":"false","aria-label":"Toggle navigation"},n.a.createElement("span",{className:"navbar-toggler-icon"})),n.a.createElement("div",{className:"".concat(a),id:"navbarResponsive"},n.a.createElement("ul",{className:"navbar-nav mr-auto"},n.a.createElement("li",{className:"nav-item navbar-brand active"},n.a.createElement(u.b,{to:"/start"},"Start")),n.a.createElement("li",{className:"nav-item navbar-brand active"},n.a.createElement(u.b,{to:"/tokengen"},"Generate")),n.a.createElement("li",{className:"nav-item navbar-brand active"},n.a.createElement(u.b,{to:"/tokenatt"},"Attenuate")),n.a.createElement("li",{className:"nav-item navbar-brand active"},n.a.createElement(u.b,{to:"/tokenver"},"Verify"))),n.a.createElement("li",{className:"nav-item navbar-brand active",style:c},n.a.createElement("a",{href:"https://github.com/acertio/biscuitsec.org"},"Github"))))}}]),r}(r.Component),p=t(1),f=t(2),h=t.n(f),b=t(3),E=function(e){return e.rules.map((function(a,t){var r="head_parameter-".concat(t),c="head_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"parameter h".concat(t+1))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"head's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"head_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2 "},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"head_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},g=function(e){return e.rules.map((function(a,t){var r="ids_parameter-".concat(t),c="ids_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3 ml-2 form-group"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"p".concat(e.rule_idx,"_").concat(t+1))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"ids's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"ids_parameter form-control"}))),n.a.createElement("div",{className:"col-0 ml-2 mr-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"ids_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},y=function(e){return e.rules.map((function(a,t){var r="caveat_ids_parameter-".concat(t),c="caveat_ids_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"p".concat(e.caveat_idx,"_").concat(t+1," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"ids's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"caveat_ids_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"caveat_ids_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},x=function(e){return e.rules.map((function(a,t){var r="caveat_head_parameter-".concat(t),c="caveat_head_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"parameter h".concat(t+1," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"head's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"caveat_head_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"caveat_head_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},N=function(e){return e.rules.map((function(a,t){var r="fact_parameter-".concat(t),c="fact_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"parameter h".concat(t+1," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"fact's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"fact_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"fact_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},w=t(7),k=t(8),S=t.n(k),C=function(e){return e.predicates.map((function(a,t){var r="",c=e.predicates[t];console.log("predicate",c);for(var l=0;l<c.rule_ids_parameter.length;l++)0===l?r+=c.rule_ids_parameter[l].param:r=r+","+c.rule_ids_parameter[l].param;return n.a.createElement("div",{key:t,className:"ml-5"},n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("div",null,"predicate ".concat(t+1,": ").concat(c.ids_name,"(").concat(r,") ")))))}))},O=function(e){return e.predicates.map((function(a,t){var r="",c=e.predicates[t];console.log("predicate",c);for(var l=0;l<c.caveat_ids_parameter.length;l++)0===l?r+=c.caveat_ids_parameter[l].param:r=r+","+c.caveat_ids_parameter[l].param;return n.a.createElement("div",{key:t,className:"ml-5"},n.a.createElement("ul",null,n.a.createElement("li",null,n.a.createElement("div",null,"predicate ".concat(t+1,": ").concat(c.ids_name,"(").concat(r,") ")))))}))},j=function(e){return e.reduce((function(e,a){return e+a.toString(16).padStart(2,"0")}),"")},T=function(e){return new Uint8Array(e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})))},A=function(e){Object(o.a)(r,e);var a=Object(m.a)(r);function r(){var e;return Object(i.a)(this,r),(e=a.call(this)).loadWasm=Object(b.a)(h.a.mark((function a(){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.e(0).then(t.bind(null,285));case 3:r=a.sent,e.setState({wasm:r}),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.error("Unexpected error in loadWasm. [Message: ".concat(a.t0.message,"]"));case 10:case"end":return a.stop()}}),a,null,[[0,7]])}))),e.handleChange=function(a){if(["head_parameter form-control"].includes(a.target.className)){var t=Object(p.a)(e.state.head_parameter);t[a.target.dataset.id].param=a.target.value,e.setState({head_parameter:t},(function(){return console.log(e.state.head_parameter)}))}else if(["ids_parameter form-control"].includes(a.target.className)){var r=Object(p.a)(e.state.ids_parameter);r[a.target.dataset.id].param=a.target.value,e.setState({ids_parameter:r},(function(){return console.log(e.state.ids_parameter)}))}else if(["ids_parameter_type form-control"].includes(a.target.className)){var n=Object(p.a)(e.state.ids_parameter);n[a.target.dataset.id].type=a.target.value,e.setState({ids_parameter:n},(function(){return console.log(e.state.ids_parameter)}))}else if(["head_parameter_type form-control"].includes(a.target.className)){var c=Object(p.a)(e.state.head_parameter);c[a.target.dataset.id].type=a.target.value,e.setState({head_parameter:c},(function(){return console.log(e.state.head_parameter)}))}else if(["head_name form-control"].includes(a.target.className))e.setState({head_name:a.target.value},(function(){return console.log(e.state.head_name)}));else if(["ids_name form-control"].includes(a.target.className))e.setState({ids_name:a.target.value},(function(){return console.log(e.state.ids_name)}));else if(["caveat_head_parameter form-control"].includes(a.target.className)){var l=Object(p.a)(e.state.caveat_head_parameter);l[a.target.dataset.id].param=a.target.value,e.setState({caveat_head_parameter:l},(function(){return console.log(e.state.caveat_head_parameter)}))}else if(["caveat_ids_parameter form-control"].includes(a.target.className)){var i=Object(p.a)(e.state.caveat_ids_parameter);i[a.target.dataset.id].param=a.target.value,e.setState({caveat_ids_parameter:i},(function(){return console.log(e.state.caveat_ids_parameter)}))}else if(["caveat_ids_parameter_type form-control"].includes(a.target.className)){var s=Object(p.a)(e.state.caveat_ids_parameter);s[a.target.dataset.id].type=a.target.value,e.setState({caveat_ids_parameter:s},(function(){return console.log(e.state.caveat_ids_parameter)}))}else if(["caveat_head_parameter_type form-control"].includes(a.target.className)){var o=Object(p.a)(e.state.caveat_head_parameter);o[a.target.dataset.id].type=a.target.value,e.setState({caveat_head_parameter:o},(function(){return console.log(e.state.caveat_head_parameter)}))}else if(["caveat_head_name form-control"].includes(a.target.className))e.setState({caveat_head_name:a.target.value},(function(){return console.log(e.state.caveat_head_name)}));else if(["caveat_ids_name form-control"].includes(a.target.className))e.setState({caveat_ids_name:a.target.value},(function(){return console.log(e.state.caveat_ids_name)}));else if(["fact_head_name form-control"].includes(a.target.className))e.setState({fact_head_name:a.target.value},(function(){return console.log(e.state.fact_head_name)}));else if(["fact_parameter form-control"].includes(a.target.className)){var m=Object(p.a)(e.state.fact_head_parameters);m[a.target.dataset.id].param=a.target.value,e.setState({fact_head_parameters:m},(function(){return console.log(e.state.fact_head_parameters)}))}else if(["fact_parameter_type form-control"].includes(a.target.className)){var d=Object(p.a)(e.state.fact_head_parameters);d[a.target.dataset.id].type=a.target.value,e.setState({fact_head_parameters:d},(function(){return console.log(e.state.fact_head_parameters)}))}},e.handleChangee=function(a){var t=e.state.token,r=btoa(String.fromCharCode.apply(String,Object(p.a)(t)));e.setState({valueEncoded:r,valueDecoded:a.target.value})},e.handleChange1=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({token:c.toVec(),valueEncoded:a.target.value,valueDecoded:c.print(),message_encoded:""})}catch(l){e.setState({valueEncoded:a.target.value}),e.setState({message_encoded:"Enter a valid token !"})}},e.handleChange_privateKey=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_privateKey:""});var n=new Uint8Array(32),c=new Uint8Array(32),l=T(a.target.value),i=r.KeyPair.fromBytes(l),s=i.publicKey();i.toBytes(n),s.toBytes(c),e.setState({privateKey:j(n),publicKey:j(c)})}catch(o){e.setState({privateKey:a.target.value}),e.setState({message_privateKey:"enter a valid key !"})}},e.handleChangee_example=function(a){var t=e.state.token_example,r=btoa(String.fromCharCode.apply(String,Object(p.a)(t)));e.setState({valueEncoded_example:r,valueDecoded_example:a.target.value})},e.handleChange1_example=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_encoded_example:""});var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({token_example:c.toVec(),valueEncoded_example:a.target.value,valueDecoded_example:c.print(),message_encoded_example:""})}catch(l){e.setState({valueEncoded_example:a.target.value}),e.setState({message_encoded_example:"Enter a valid token !"})}},e.handleChange2=function(a){e.setState({restrict:a.target.value})},e.handleChange3=function(a){e.setState({resource:a.target.value})},e.handleChange4=function(a){e.setState({resource_verify:a.target.value})},e.handleChange4_example=function(a){e.setState({resource_verify_example:a.target.value})},e.handleChange5_example=function(a){e.setState({restrict_verify_example:a.target.value})},e.handleChange5=function(a){e.setState({restrict_verify:a.target.value})},e.handleChange6=function(a){e.setState({seconds:a.target.value})},e.delPredicate_rule=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setState({rule_predicate_deleting:""}),a.prev=1,console.log("in predicate rule body",e.state.rule_body),0!==e.state.rule_body.length){a.next=7;break}throw SyntaxError("You don't have any predicate to delete !");case 7:if(1!==e.state.rule_body.length){a.next=11;break}e.setState({rule_body:[],rule_predicate_deleting:"Your last predicate has been deleted",rule_predicate_adding:""}),a.next=17;break;case 11:return r=Object(p.a)(e.state.rule_body.splice(e.state.rule_body.length-1,1)),console.log("in predicate rule body",r),e.setState((function(e){return{rule_body:Object(p.a)(r),rule_predicate_deleting:"Your last predicate has been deleted",rule_predicate_adding:""}})),a.next=16,new Promise((function(e){return setTimeout(e,3e3)}));case 16:console.log("last rule body",e.state.rule_body);case 17:a.next=22;break;case 19:a.prev=19,a.t0=a.catch(1),e.setState({rule_predicate_deleting:a.t0.message});case 22:case"end":return a.stop()}}),a,null,[[1,19]])})));return function(e){return a.apply(this,arguments)}}(),e.delPredicate_caveat=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setState({caveat_predicate_deleting:""}),a.prev=1,console.log("in predicate caveat body",e.state.caveat_body),0!==e.state.caveat_body.length){a.next=7;break}throw SyntaxError("You don't have any predicate to delete !");case 7:if(1!==e.state.caveat_body.length){a.next=11;break}e.setState({caveat_body:[],caveat_predicate_deleting:"Your last predicate has been deleted",caveat_predicate_adding:""}),a.next=17;break;case 11:return r=Object(p.a)(e.state.caveat_body.splice(e.state.caveat_body.length-1,1)),console.log("in predicate caveat body",r),e.setState((function(e){return{caveat_body:Object(p.a)(r),caveat_predicate_deleting:"Your last predicate has been deleted",caveat_predicate_adding:""}})),a.next=16,new Promise((function(e){return setTimeout(e,3e3)}));case 16:console.log("last caveat body",e.state.caveat_body);case 17:a.next=22;break;case 19:a.prev=19,a.t0=a.catch(1),e.setState({caveat_predicate_deleting:a.t0.message});case 22:case"end":return a.stop()}}),a,null,[[1,19]])})));return function(e){return a.apply(this,arguments)}}(),e.addPredicate_rule=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.setState({rule_predicate_adding:""}),a.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:console.log(e.state.number_of_added_rules_ids),a.prev=4,console.log("in predicate rule body",e.state.rule_body),r=0;case 7:if(!(r<e.state.ids_parameter.length)){a.next=14;break}if(console.log("ids parameter counter",e.state.ids_parameter.length),""!==e.state.ids_name&&""!==e.state.ids_parameter[r].param&&""!==e.state.ids_parameter[r].type){a.next=11;break}throw SyntaxError("all predicate fields must be filled out");case 11:r++,a.next=7;break;case 14:if(0!==e.state.rule_body.length){a.next=20;break}return e.setState({rule_body:[{ids_name:e.state.ids_name,rule_ids_parameter:e.state.ids_parameter}],ids_name:"",ids_parameter:[{param:"",type:""}],rule_predicate_adding:"your predicate has been added",rule_idx:e.state.rule_idx+1,hidden_msg_predicate:"Your added predicates :"}),a.next=18,new Promise((function(e){return setTimeout(e,1e3)}));case 18:a.next=21;break;case 20:e.setState((function(a){return{rule_body:[].concat(Object(p.a)(e.state.rule_body),[{ids_name:e.state.ids_name,rule_ids_parameter:e.state.ids_parameter}]),ids_name:"",ids_parameter:[{param:"",type:""}],rule_predicate_adding:"your predicate has been added",rule_idx:e.state.rule_idx+1,hidden_msg_predicate:"Your added predicates :"}}));case 21:a.next=26;break;case 23:a.prev=23,a.t0=a.catch(4),e.setState({rule_predicate_adding:a.t0.message});case 26:case"end":return a.stop()}}),a,null,[[4,23]])})));return function(e){return a.apply(this,arguments)}}(),e.addPredicate_caveat=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.setState({caveat_predicate_adding:""}),a.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:a.prev=3,r=0;case 5:if(!(r<e.state.caveat_ids_parameter.length)){a.next=11;break}if(""!==e.state.caveat_ids_name&&""!==e.state.caveat_ids_parameter[r].param&&""!==e.state.caveat_ids_parameter[r].type){a.next=8;break}throw SyntaxError("all predicate fields must be filled out");case 8:r++,a.next=5;break;case 11:if(0!==e.state.caveat_body.length){a.next=17;break}return e.setState({caveat_body:[{ids_name:e.state.caveat_ids_name,caveat_ids_parameter:e.state.caveat_ids_parameter}],caveat_ids_name:"",caveat_ids_parameter:[{param:"",type:""}],caveat_predicate_adding:"your predicate has been added",caveat_idx:e.state.caveat_idx+1,caveat_hidden_msg_predicate:"Your added predicates :"}),a.next=15,new Promise((function(e){return setTimeout(e,1e3)}));case 15:a.next=18;break;case 17:e.setState((function(a){return{caveat_body:[].concat(Object(p.a)(a.caveat_body),[{ids_name:e.state.caveat_ids_name,caveat_ids_parameter:e.state.caveat_ids_parameter}]),caveat_ids_name:"",caveat_ids_parameter:[{param:"",type:""}],caveat_predicate_adding:"your predicate has been added",caveat_idx:e.state.caveat_idx+1,caveat_hidden_msg_predicate:"Your added predicates :"}}));case 18:a.next=23;break;case 20:a.prev=20,a.t0=a.catch(3),e.setState({caveat_predicate_adding:a.t0.message});case 23:case"end":return a.stop()}}),a,null,[[3,20]])})));return function(e){return a.apply(this,arguments)}}(),e.addFact=function(){var a=Object(b.a)(h.a.mark((function a(t){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState((function(a){return{fact_head_parameters:[].concat(Object(p.a)(a.fact_head_parameters),[{param:"",type:""}]),number_of_added_fact:e.state.number_of_added_fact+1}}));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.addRule1_caveat=function(a){e.setState((function(a){return{caveat_ids_parameter:[].concat(Object(p.a)(a.caveat_ids_parameter),[{param:"",type:""}]),number_of_added_caveats_ids:e.state.number_of_added_caveats_ids+1}}))},e.addRule_caveat=function(a){e.setState((function(a){return{caveat_head_parameter:[].concat(Object(p.a)(a.caveat_head_parameter),[{param:"",type:""}]),number_of_added_caveats_head:e.state.number_of_added_caveats_head+1}}))},e.addRule1=function(a){e.setState((function(a){return{ids_parameter:[].concat(Object(p.a)(a.ids_parameter),[{param:"",type:""}]),number_of_added_rules_ids:e.state.number_of_added_rules_ids+1}}))},e.addRule=function(a){e.setState((function(a){return{head_parameter:[].concat(Object(p.a)(a.head_parameter),[{param:"",type:""}]),number_of_added_rules_head:e.state.number_of_added_rules_head+1}}))},e.state={token:[],token_example:[],token_verification:[],tokenToAttenuate:[],valueEncoded:"",valueDecoded:"",valueEncodedToAttenuate:"",valueDecodedToAttenuate:"",valueEncoded_example:"",valueEncoded_verification:"",valueDecoded_example:"",valueDecoded_verification:"",privateKey:"",publicKey:"",privateKey_own_verification:"",publicKey_own_verification:"",attenuation_publicKey:"",attenuation_privateKey:"",restrict:"",resource:"",expiration:"",restrict_verify:"",restrict_operation_message:"",resource_prefix_message:"",token_revocation_message:"",restrict_verify_example:"",resource_verify:"",resource_verify_example:"",seconds:"",result_verification:"",gen_err:"",gen_err_empty:"",gen_err_example:"",gen_err_attenuation:"",result_verification_example:"",message_encoded_verification:"",message_encoded_example:"",message_encoded_attenuation:"",message_encoded:"",message_privateKey:"",message_privateKey_own_verification:"",message_privateKey_attenuation:"",copied:!1,head_parameter:[{param:"",type:""}],ids_parameter:[{param:"",type:""}],head_name:"",ids_name:"",rules:[{head_parameter:[{param:"",type:""}],head_name:"",body:[]}],rule_adding_message:"",rule_counter:0,number_of_added_rules_head:0,number_of_added_rules_ids:0,rule_body:[],rule_predicate_adding:"",rule_idx:1,hidden_msg_predicate:"",rule_predicate_deleting:"",fact_head_name:"",fact_head_parameters:[{param:"",type:""}],facts:[{fact_head_parameters:[{param:"",type:""}],fact_head_name:""}],fact_adding_message:"",fact_counter:0,number_of_added_fact:0,caveat_head_parameter:[{param:"",type:""}],caveat_ids_parameter:[{param:"",type:""}],caveat_head_name:"",caveat_ids_name:"",caveats:[{head_parameter:[{param:"",type:""}],head_name:"",body:[]}],caveat_adding_message:"",caveat_counter:0,number_of_added_caveats_head:0,number_of_added_caveats_ids:0,caveat_body:[],caveat_predicate_adding:"",caveat_idx:1,caveat_hidden_msg_predicate:"",caveat_predicate_deleting:""},e}return Object(s.a)(r,[{key:"componentDidMount",value:function(){this.loadWasm()}},{key:"copy",value:function(){this.setState({copied:!0}),this.textArea.select(),document.execCommand("copy")}},{key:"render",value:function(){var e=this,a=this.state.wasm,t=void 0===a?{}:a,r=function(){var a=T(e.state.privateKey);return t.KeyPair.fromBytes(a)},c=this.state.copied?"Copied":"Copy to clipboard",l=Object(p.a)(this.state.head_parameter),i=Object(p.a)(this.state.caveat_head_parameter),s=Object(p.a)(this.state.fact_head_parameters),o=Object(p.a)(this.state.ids_parameter),m=Object(p.a)(this.state.caveat_ids_parameter);return n.a.createElement("div",null,n.a.createElement("div",{className:"container-fluid"},n.a.createElement("div",{className:"warning"},n.a.createElement("div",{className:"text-center"},n.a.createElement("strong",null,"Biscuitsec :"),"Learn how the biscuit token works by interacting with it. For developers, the code of the application is available on our github")),"                    ",n.a.createElement("h1",{className:"mr-5 text-center"},"Token Generation "),n.a.createElement("br",null),n.a.createElement("h2",{className:"mr-5 ml-5"},"Root Keys Generation "),n.a.createElement("div",{className:"mr-5 ml-5"},"Biscuits use public key cryptography. You can either use an existing public/private keypair, or we'll generate one for you.",n.a.createElement("br",null)," Please note this site does not record neither the provided keys nor the generated tokens. "),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-12"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"Public Key"))," ",n.a.createElement("small",null," press the button to generate your keys"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea2",type:"text",readOnly:!0,value:this.state.publicKey,rows:"2"}))),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{className:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"Private Key")),n.a.createElement("small",null," if you wanna use your private key paste it here"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",type:"text",value:this.state.privateKey,onChange:this.handleChange_privateKey,rows:"2"})),n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var r,n,c,l;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({message_privateKey:""}),r=new Uint8Array(32),n=new Uint8Array(32),c=new t.KeyPair,l=c.publicKey(),c.toBytes(r),l.toBytes(n),e.setState({privateKey:j(r),publicKey:j(n)});case 8:case"end":return a.stop()}}),a)})))},"Generate keys"),n.a.createElement("div",null,this.state.message_privateKey)))),n.a.createElement("br",null),n.a.createElement("h1",{className:"mr-5 ml-5"},"Generate Your Own Token "),n.a.createElement("div",{className:"mr-5 ml-5"},'You"ll now learn how to create the different components (facts, rules, caveats) of a biscuit token, from scratch'),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10",onChange:this.handleChange},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-4 ml-5 mr-5"},n.a.createElement("h2",null,"add a new authority fact"))),n.a.createElement("div",{className:"ml-5 mr-5"},"Authority facts can only be created in the authority block, either directly or from rules, and are represented by the #authority symbol as the first element of a fact.",n.a.createElement("br",null)," ",n.a.createElement("strong",null,"They hold the initial rights for the token")," .",n.a.createElement("br",null)," it's a predicate which looks like Predicate(v0, v1, ..., vn) : Predicate si the fact name and v0,v1,...,vn are the fact parameters",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 ml-5 mr-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"fact name ")),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{variant:"outlined",type:"text",value:this.state.fact_head_name,className:"fact_head_name form-control",id:"fact-head-name",row:"1"}))),n.a.createElement(N,{rules:s,type:"text"}),n.a.createElement("div",{className:"col-0 mr-3 "},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement(w.a,{onClick:this.addFact},n.a.createElement(S.a,null))))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-0  "},n.a.createElement("button",{className:"col-12",onClick:Object(b.a)(h.a.mark((function a(){var t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.prev=0,e.setState({fact_adding_message:""}),t=0;case 3:if(!(t<e.state.fact_head_parameters.length)){a.next=9;break}if(""!==e.state.fact_head_name&&""!==e.state.fact_head_parameters[t].param&&""!==e.state.fact_head_parameters[t].type){a.next=6;break}throw SyntaxError("Incomplete data: all fields must be filled out");case 6:t++,a.next=3;break;case 9:0===e.state.fact_counter?(console.log("number of facts",e.state.number_of_added_fact),e.setState({facts:[{fact_head_parameters:e.state.fact_head_parameters,fact_head_name:e.state.fact_head_name}]})):e.setState((function(a){return{facts:[].concat(Object(p.a)(a.facts),[{fact_head_parameters:e.state.fact_head_parameters,fact_head_name:e.state.fact_head_name}])}})),e.setState({fact_head_name:"",fact_head_parameters:[{param:"",type:""}]}),e.setState({fact_adding_message:"Your new fact has been added"}),e.setState({fact_counter:e.state.fact_counter+1}),a.next=18;break;case 15:a.prev=15,a.t0=a.catch(0),e.setState({fact_adding_message:a.t0.message});case 18:case"end":return a.stop()}}),a,null,[[0,15]])})))},"Add fact")),n.a.createElement("div",{className:"col-2 ml-3"},n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({fact_head_name:"",fact_head_parameters:[{param:"",type:""}],fact_adding_message:""});case 1:case"end":return a.stop()}}),a)})))},"Reset fact")))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-2 mr-2 "},n.a.createElement("div",{id:"fact_adding_result"},this.state.fact_adding_message))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-3 ml-5 mr-5"},n.a.createElement("h2",null,"Add a new rule"))),n.a.createElement("div",{className:"ml-5 mr-5"},"A rule is a comination of predicates pid1 ,pid2 ,etc.that will generate a new fact corresponding to the head."),n.a.createElement("div",{className:"mr-5 ml-5"},"The rule looks like this (with a head part on the left and a body part on the right) :  ",n.a.createElement("pre",null,"head(h1,h2,...) <- pid1(p1_1,p1_2...), pid2(p2_1,p2_2, ...)")," "),n.a.createElement("div",{className:"ml-5"},"For more details and some explained examples of rules click ",n.a.createElement("a",{href:"https://www.w3schools.com/"},"here")," to check our documentation"),n.a.createElement("br",null),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h3",null,"Header (left part of the rule)")),n.a.createElement("div",{className:"ml-5"},"The header is a Predicate composed from a name ( head ) and  some parameters (at least h1)."),n.a.createElement("div",{className:"ml-5"}," The + allows you to add other parameters (h2,h3,etc.)"),n.a.createElement("div",{className:"row"}),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 ml-5 mr-2 "},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"head name ")),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{variant:"outlined",type:"text",value:this.state.head_name,className:"head_name form-control",id:"head-name",row:"1"}))),n.a.createElement(E,{rules:l,type:"text"}),n.a.createElement("div",{className:"col-0 mr-3 "},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement(w.a,{onClick:this.addRule},n.a.createElement(S.a,null))))),n.a.createElement("br",null),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h3",null,"Body : the part on the left")),n.a.createElement("div",{className:"ml-5"},"The body may be decomposed into several predicates(pid1,pid2,etc)."),n.a.createElement("div",{className:"ml-5"},"Each body predicate is composed of its identifier id (e.g. pid1) and one or several parameters (e.g. p1_1)."),n.a.createElement("div",{className:"ml-5"},"Click ",n.a.createElement("a",{href:"https://www.w3schools.com/"},"here")," for more details and explained examples."),n.a.createElement("div",{className:"ml-5"},'You may either add a parameter (e.g. p1_2) with the button + , or add a new body predicate (e.g. pid2 ) using the "add predicate" button.'),n.a.createElement("h5",{className:"ml-5"},this.state.hidden_msg_predicate),n.a.createElement(C,{predicates:this.state.rule_body}),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"pid".concat(this.state.rule_idx," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{id:"outlined-basic",label:"ids",variant:"outlined",type:"text",value:this.state.ids_name,className:"ids_name form-control"}))),n.a.createElement(g,{rules:o,rule_idx:this.state.rule_idx,type:"text",value:this.state.ids_parameter,className:"ids_parameter"}),n.a.createElement("div",{className:"col-0 mr-2"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("h3",null,n.a.createElement(w.a,{onClick:this.addRule1},n.a.createElement(S.a,null))))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.addPredicate_rule},"Add predicate"),n.a.createElement("div",null,this.state.rule_predicate_adding))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.delPredicate_rule},"Delete last predicate"),n.a.createElement("div",null,this.state.rule_predicate_deleting)))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-0 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.prev=0,e.setState({rule_adding_message:""}),t=0;case 3:if(!(t<e.state.head_parameter.length)){a.next=9;break}if(""!==e.state.head_name&&""!==e.state.head_parameter[t].param&&""!==e.state.head_parameter[t].type){a.next=6;break}throw SyntaxError("Incomplete data: all fields must be filled out");case 6:t++,a.next=3;break;case 9:if(0!==e.state.rule_counter){a.next=15;break}if(0!==e.state.rule_body.length){a.next=12;break}throw SyntaxError("You must at least add one predicate");case 12:e.setState({rules:[{head_parameter:e.state.head_parameter,head_name:e.state.head_name,body:e.state.rule_body}]}),a.next=18;break;case 15:if(0!==e.state.rule_body.length){a.next=17;break}throw SyntaxError("You must at least add one predicate !");case 17:e.setState((function(a){return{rules:[].concat(Object(p.a)(a.rules),[{head_parameter:e.state.head_parameter,head_name:e.state.head_name,body:e.state.rule_body}])}}));case 18:e.setState({rule_adding_message:"Your new rule has been added"}),e.setState({rule_predicate_adding:""}),e.setState({rule_counter:e.state.rule_counter+1}),e.setState({head_parameter:[{param:"",type:""}],head_name:"",rule_idx:1,body:[],rule_body:[]}),a.next=27;break;case 24:a.prev=24,a.t0=a.catch(0),e.setState({rule_adding_message:a.t0.message});case 27:case"end":return a.stop()}}),a,null,[[0,24]])})))},"Add rule"))),n.a.createElement("div",{className:"col-2 ml-3"},n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({head_parameter:[{param:"",type:""}],ids_parameter:[{param:"",type:""}],head_name:"",ids_name:"",rule_adding_message:"Your rule has been resetted ",rule_body:[],rule_predicate_adding:"",rule_idx:1,hidden_msg_predicate:"",rule_predicate_deleting:""});case 1:case"end":return a.stop()}}),a)})))},"Reset rule")))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-2 mr-2 "},n.a.createElement("div",{id:"rule_adding_result"},this.state.rule_adding_message)))),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10",onChange:this.handleChange},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-3 ml-5 mr-5"},n.a.createElement("h2",null,"Add a new caveat"))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"mr-5 ml-5"},"Caveats are logic queries evaluating conditions on authority and ambient facts. To validate an operation, all of a token's caveats must succeed."),n.a.createElement("div",{className:"mr-5 ml-5"},"The caveat have the same structure as the rule.")),n.a.createElement("br",null),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h4",null,"Header")),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 mr-2 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"head name ")),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{variant:"outlined",type:"text",value:this.state.caveat_head_name,className:"caveat_head_name form-control",id:"head-name",row:"1"}))),n.a.createElement(x,{rules:i,head_names:this.state.caveat_head_namee,type:"text"}),n.a.createElement("div",{className:"col-0 mr-3 "},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row ml-1"},n.a.createElement(w.a,{onClick:this.addRule_caveat},n.a.createElement(S.a,null))))),n.a.createElement("br",null),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h4",null,"Body")),n.a.createElement("h5",{className:"ml-5"},this.state.caveat_hidden_msg_predicate),n.a.createElement(O,{predicates:this.state.caveat_body}),n.a.createElement("div",{className:"row "},n.a.createElement("div",{className:"col-1 mr-2 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"pid".concat(this.state.caveat_idx," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{id:"outlined-basic",label:"ids",variant:"outlined",type:"text",value:this.state.caveat_ids_name,className:"caveat_ids_name form-control"}))),n.a.createElement(y,{rules:m,caveat_idx:this.state.caveat_idx,head_names:this.state.caveat_head_namee,type:"text",value:this.state.ids_parameter,className:"caveat_ids_parameter"}),n.a.createElement("div",{className:"col-0 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row ml-1"},n.a.createElement("h3",null,n.a.createElement(w.a,{onClick:this.addRule1_caveat},n.a.createElement(S.a,null))))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.addPredicate_caveat},"Add predicate"),n.a.createElement("div",null,this.state.caveat_predicate_adding))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.delPredicate_caveat},"Delete last predicate"),n.a.createElement("div",null,this.state.caveat_predicate_deleting)))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-0 "},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.prev=0,e.setState({caveat_adding_message:""}),t=0;case 3:if(!(t<e.state.caveat_head_parameter.length)){a.next=9;break}if(""!==e.state.caveat_head_name&&""!==e.state.caveat_head_parameter[t].param&&""!==e.state.caveat_head_parameter[t].type){a.next=6;break}throw SyntaxError("Incomplete data: all fields must be filled out");case 6:t++,a.next=3;break;case 9:if(0!==e.state.caveat_counter){a.next=19;break}if(0!==e.state.caveat_body.length){a.next=12;break}throw SyntaxError("You must at least add one predicate !");case 12:return console.log(e.state.head_name),e.setState({caveats:[{head_parameter:e.state.caveat_head_parameter,head_name:e.state.caveat_head_name,body:e.state.caveat_body}]}),a.next=16,new Promise((function(e){return setTimeout(e,2e3)}));case 16:console.log("caveats",e.state.caveats),a.next=26;break;case 19:if(console.log("here",e.state.number_of_added_caveats_head),0!==e.state.caveat_body.length){a.next=22;break}throw SyntaxError("You must at least add one predicate !");case 22:return e.setState((function(a){return{caveats:[].concat(Object(p.a)(a.caveats),[{head_parameter:e.state.caveat_head_parameter,head_name:e.state.caveat_head_name,body:e.state.caveat_body}])}})),a.next=25,new Promise((function(e){return setTimeout(e,2e3)}));case 25:console.log("caveats",e.state.caveats);case 26:e.setState({caveat_adding_message:"Your new ceveat has been added"}),e.setState({caveat_counter:e.state.rule_counter+1}),e.setState({caveat_head_name:"",caveat_ids_parameter:[{param:"",type:""}],caveat_head_parameter:[{param:"",type:""}],caveat_ids_name:""}),e.setState({caveat_head_name:"",caveat_head_parameter:[{param:"",type:""}],caveat_idx:1,body:[],caveat_body:[]}),a.next=35;break;case 32:a.prev=32,a.t0=a.catch(0),e.setState({caveat_adding_message:a.t0.message});case 35:case"end":return a.stop()}}),a,null,[[0,32]])})))},"Add caveat")),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({caveat_head_parameter:[{param:"",type:""}],caveat_ids_parameter:[{param:"",type:""}],caveat_head_name:"",caveat_ids_name:"",caveat_adding_message:"",number_of_added_caveats_head:0,number_of_added_caveats_ids:0,caveat_body:[],caveat_predicate_adding:"",caveat_idx:1,caveat_hidden_msg_predicate:"",caveat_predicate_deleting:""});case 1:case"end":return a.stop()}}),a)})))},"Reset caveat")))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-2 mr-2 "},n.a.createElement("div",{id:"caveat_adding_result"},this.state.caveat_adding_message))),n.a.createElement("br",null)," ",n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"textarea-container"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"ENCODED"))," ",n.a.createElement("small",null," paste a token here"),n.a.createElement("textarea",{ref:function(a){return e.textArea=a},className:"form-control",id:"exampleFormControlTextarea2",type:"text",value:this.state.valueEncoded,onChange:this.handleChange1,rows:"15"}),n.a.createElement("a",{onClick:function(){return e.copy()}},c)),n.a.createElement("div",null,this.state.message_encoded)),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"DECODED")),n.a.createElement("small",null," your result"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",readOnly:!0,type:"text",value:this.state.valueDecoded,onChange:this.handleChangee,rows:"15"})),n.a.createElement("div",{id:"generation_result"},this.state.gen_err_empty)))),n.a.createElement("div",{className:"mr-5 ml-5"},"In order to create your first token add your rules , fact and caveat , then click on the generate button"),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-4"}),n.a.createElement("div",{className:"col-2 ml-5"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var n,c,l,i,s,o,m,d,_,u,v,f,b,E,g,y,x,N,w,k,S,C,O,j,T,A,K,F,D,P,Y,B,I;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setState({gen_err:""}),n=new t.Biscuit,console.log("rule counter :",e.state.rule_counter),e.state.rule_counter>0)for(c=0;c<e.state.rules.length;c++){for(console.log("step {}",c),l=Object(p.a)(e.state.rules[c].head_parameter),i=[],s=0;s<l.length;s++)"variable"===l[s].type?i=[].concat(Object(p.a)(i),[{variable:parseInt(l[s].param)}]):"string"===l[s].type?i=[].concat(Object(p.a)(i),[{string:l[s].param}]):"symbol"===l[s].type?i=[].concat(Object(p.a)(i),[{symbol:l[s].param}]):"integer"===l[s].type?i=[].concat(Object(p.a)(i),[{integer:parseInt(l[s].param)}]):"date"===l[s].type&&(i=[].concat(Object(p.a)(i),[{date:Date.parse(l[s].param)}]));for(o=Object(p.a)(e.state.rules[c].body),m=[],d=0;d<o.length;d++){for(_=o[d].ids_name,u=Object(p.a)(o[d].rule_ids_parameter),v=[],f=0;f<u.length;f++)"variable"===u[f].type?v=[].concat(Object(p.a)(v),[{variable:parseInt(u[f].param)}]):"string"===u[f].type?v=[].concat(Object(p.a)(v),[{string:u[f].param}]):"symbol"===u[f].type?v=[].concat(Object(p.a)(v),[{symbol:u[f].param}]):"integer"===u[f].type?v=[].concat(Object(p.a)(v),[{integer:parseInt(u[f].param)}]):"date"===u[f].type&&(v=[].concat(Object(p.a)(v),[{date:Date.parse(u[f].param)}]));m=[].concat(Object(p.a)(m),[{name:_,ids:v}])}console.log("body_for_rule",m),b=t.rule(e.state.rules[c].head_name,i,m),console.log("authority rule ",b),n.addAuthorityRule(b)}if(console.log("fact counter :",e.state.fact_counter),e.state.fact_counter>0)for(E=0;E<e.state.facts.length;E++){for(g=Object(p.a)(e.state.facts[E].fact_head_parameters),y=[],x=0;x<g.length;x++)"variable"===g[x].type?y=[].concat(Object(p.a)(y),[{variable:parseInt(g[x].param)}]):"string"===g[x].type?y=[].concat(Object(p.a)(y),[{string:g[x].param}]):"symbol"===g[x].type?y=[].concat(Object(p.a)(y),[{symbol:g[x].param}]):"date"===g[x].type?y=[].concat(Object(p.a)(y),[{date:Date.parse(g[x].param)}]):"integer"===g[x].type&&(y=[].concat(Object(p.a)(y),[{integer:parseInt(g[x].param)}]));N=t.fact(e.state.facts[E].fact_head_name,y),n.addAuthorityFact(N)}if(console.log("caveat counter :",e.state.caveat_counter),e.state.caveat_counter>0)for(w=0;w<e.state.caveats.length;w++){for(console.log("step {}",w),k=Object(p.a)(e.state.caveats[w].head_parameter),S=[],C=0;C<k.length;C++)"variable"===k[C].type?S=[].concat(Object(p.a)(S),[{variable:parseInt(k[C].param)}]):"string"===k[C].type?S=[].concat(Object(p.a)(S),[{string:k[C].param}]):"symbol"===k[C].type?S=[].concat(Object(p.a)(S),[{symbol:k[C].param}]):"date"===k[C].type?S=[].concat(Object(p.a)(S),[{date:Date.parse(k[C].param)}]):"integer"===k[C].type&&(S=[].concat(Object(p.a)(S),[{integer:parseInt(k[C].param)}]));for(O=Object(p.a)(e.state.caveats[w].body),j=[],T=0;T<O.length;T++){for(A=O[T].ids_name,K=Object(p.a)(O[T].caveat_ids_parameter),F=[],D=0;D<K.length;D++)"variable"===K[D].type?F=[].concat(Object(p.a)(F),[{variable:parseInt(K[D].param)}]):"string"===K[D].type?F=[].concat(Object(p.a)(F),[{string:K[D].param}]):"symbol"===K[D].type?F=[].concat(Object(p.a)(F),[{symbol:K[D].param}]):"date"===K[D].type?F=[].concat(Object(p.a)(F),[{date:Date.parse(K[D].param)}]):"integer"===K[D].type&&(F=[].concat(Object(p.a)(F),[{integer:parseInt(K[D].param)}]));j=[].concat(Object(p.a)(j),[{name:A,ids:F}])}console.log("body_for_rule",j),P=t.rule(e.state.caveats[w].head_name,S,j),n.addAuthorityCaveat(P)}try{Y=n.build(r()),B=Y.toVec(),I=btoa(String.fromCharCode.apply(String,Object(p.a)(B))),e.setState({token:Y.toVec(),valueEncoded:I,valueDecoded:Y.print()}),e.setState({head_parameter:[{param:"",type:""}],ids_parameter:[{param:"",type:""}],head_name:"",ids_name:"",rules:[{head_parameter:[{param:"",type:""}],head_name:"",body:[]}],rule_adding_message:"",rule_counter:0,number_of_added_rules_head:0,number_of_added_rules_ids:0,rule_body:[],rule_predicate_adding:"",rule_idx:1,fact_head_name:"",fact_head_parameters:[{param:"",type:""}],facts:[{fact_head_parameters:[{param:"",type:""}],fact_head_name:""}],fact_adding_message:"",fact_counter:0,number_of_added_fact:0,caveat_head_parameter:[{param:"",type:""}],caveat_ids_parameter:[{param:"",type:""}],caveat_head_name:"",caveat_ids_name:"",caveats:[{head_parameter:[{param:"",type:""}],head_name:"",body:[]}],caveat_adding_message:"",caveat_counter:0,number_of_added_caveats_head:0,number_of_added_caveats_ids:0,caveat_body:[],caveat_predicate_adding:"",caveat_idx:1})}catch(h){e.setState({gen_err:"You must generate your keypair before generating your token !"})}case 9:case"end":return a.stop()}}),a)})))}," Generate your new token "),n.a.createElement("div",{id:"verification_result"},this.state.gen_err))))))}}]),r}(n.a.Component),K=t(79),F=function(e){return e.rules.map((function(a,t){var r="attenuation_head_parameter-".concat(t),c="attenuation_head_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"parameter h".concat(t+1))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"head's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"attenuation_head_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"attenuation_head_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},D=function(e){return e.rules.map((function(a,t){var r="attenuation_ids_parameter-".concat(t),c="attenuation_ids_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"p".concat(e.rule_idx,"_").concat(t+1))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"ids's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"attenuation_ids_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"attenuation_ids_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},P=function(e){return e.rules.map((function(a,t){var r="attenuation_fact_parameter-".concat(t),c="attenuation_fact_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"parameter h".concat(t+1," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"fact's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"attenuation_fact_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"attenuation_fact_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},Y=function(e){return e.rules.map((function(a,t){var r="attenuation_caveat_head_parameter-".concat(t),c="attenuation_caveat_head_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"parameter h".concat(t+1," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"head's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"attenuation_caveat_head_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"attenuation_caveat_head_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},B=function(e){return e.rules.map((function(a,t){var r="attenuation_caveat_ids_parameter-".concat(t),c="attenuation_caveat_ids_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"p".concat(e.caveat_idx,"_").concat(t+1," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"ids's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"attenuation_caveat_ids_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"attenuation_caveat_ids_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},I=function(e){return e.reduce((function(e,a){return e+a.toString(16).padStart(2,"0")}),"")},R=function(e){return new Uint8Array(e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})))},V=function(e){Object(o.a)(r,e);var a=Object(m.a)(r);function r(){var e;return Object(i.a)(this,r),(e=a.call(this)).loadWasm=Object(b.a)(h.a.mark((function a(){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.e(0).then(t.bind(null,285));case 3:r=a.sent,e.setState({wasm:r}),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.error("Unexpected error in loadWasm. [Message: ".concat(a.t0.message,"]"));case 10:case"end":return a.stop()}}),a,null,[[0,7]])}))),e.handleChange=function(a){if(["attenuation_head_parameter form-control"].includes(a.target.className)){var t=Object(p.a)(e.state.attenuation_head_parameter);t[a.target.dataset.id].param=a.target.value,e.setState({attenuation_head_parameter:t},(function(){return console.log(e.state.attenuation_head_parameter)}))}else if(["attenuation_ids_parameter form-control"].includes(a.target.className)){var r=Object(p.a)(e.state.attenuation_ids_parameter);r[a.target.dataset.id].param=a.target.value,e.setState({attenuation_ids_parameter:r},(function(){return console.log(e.state.attenuation_ids_parameter)}))}else if(["attenuation_ids_parameter_type form-control"].includes(a.target.className)){var n=Object(p.a)(e.state.attenuation_ids_parameter);n[a.target.dataset.id].type=a.target.value,e.setState({attenuation_ids_parameter:n},(function(){return console.log(e.state.attenuation_ids_parameter)}))}else if(["attenuation_head_parameter_type form-control"].includes(a.target.className)){var c=Object(p.a)(e.state.attenuation_head_parameter);c[a.target.dataset.id].type=a.target.value,e.setState({attenuation_head_parameter:c},(function(){return console.log(e.state.attenuation_head_parameter)}))}else if(["attenuation_head_name form-control"].includes(a.target.className))e.setState({attenuation_head_name:a.target.value},(function(){return console.log(e.state.attenuation_head_name)}));else if(["attenuation_ids_name form-control"].includes(a.target.className))e.setState({attenuation_ids_name:a.target.value},(function(){return console.log(e.state.attenuation_ids_name)}));else if(["attenuation_caveat_head_parameter form-control"].includes(a.target.className)){var l=Object(p.a)(e.state.attenuation_caveat_head_parameter);l[a.target.dataset.id].param=a.target.value,e.setState({attenuation_caveat_head_parameter:l},(function(){return console.log(e.state.attenuation_caveat_head_parameter)}))}else if(["attenuation_caveat_ids_parameter form-control"].includes(a.target.className)){var i=Object(p.a)(e.state.attenuation_caveat_ids_parameter);i[a.target.dataset.id].param=a.target.value,e.setState({attenuation_caveat_ids_parameter:i},(function(){return console.log(e.state.attenuation_caveat_ids_parameter)}))}else if(["attenuation_caveat_ids_parameter_type form-control"].includes(a.target.className)){var s=Object(p.a)(e.state.attenuation_caveat_ids_parameter);s[a.target.dataset.id].type=a.target.value,e.setState({attenuation_caveat_ids_parameter:s},(function(){return console.log(e.state.attenuation_caveat_ids_parameter)}))}else if(["attenuation_caveat_head_parameter_type form-control"].includes(a.target.className)){var o=Object(p.a)(e.state.attenuation_caveat_head_parameter);o[a.target.dataset.id].type=a.target.value,e.setState({attenuation_caveat_head_parameter:o},(function(){return console.log(e.state.attenuation_caveat_head_parameter)}))}else if(["attenuation_caveat_head_name form-control"].includes(a.target.className))e.setState({attenuation_caveat_head_name:a.target.value},(function(){return console.log(e.state.attenuation_caveat_head_name)}));else if(["attenuation_caveat_ids_name form-control"].includes(a.target.className))e.setState({attenuation_caveat_ids_name:a.target.value},(function(){return console.log(e.state.attenuation_caveat_ids_name)}));else if(["attenuation_fact_head_name form-control"].includes(a.target.className))e.setState({attenuation_fact_head_name:a.target.value},(function(){return console.log(e.state.attenuation_fact_head_name)}));else if(["attenuation_fact_parameter form-control"].includes(a.target.className)){var m=Object(p.a)(e.state.attenuation_fact_head_parameters);m[a.target.dataset.id].param=a.target.value,e.setState({attenuation_fact_head_parameters:m},(function(){return console.log(e.state.attenuation_fact_head_parameters)}))}else if(["attenuation_fact_parameter_type form-control"].includes(a.target.className)){var d=Object(p.a)(e.state.attenuation_fact_head_parameters);d[a.target.dataset.id].type=a.target.value,e.setState({attenuation_fact_head_parameters:d},(function(){return console.log(e.state.attenuation_fact_head_parameters)}))}},e.handleChangee=function(a){var t=e.state.token,r=btoa(String.fromCharCode.apply(String,Object(p.a)(t)));e.setState({valueEncoded:r,valueDecoded:a.target.value})},e.handleChangee_attenuation=function(a){var t=e.state.tokenToAttenuate,r=btoa(String.fromCharCode.apply(String,Object(p.a)(t)));e.setState({valueEncodedToAttenuate:r,valueDecodedToAttenuate:a.target.value})},e.handleChange1_attenuation=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({tokenToAttenuate:c.toVec(),valueEncodedToAttenuate:a.target.value,valueDecodedToAttenuate:c.print(),message_encoded_attenuation:""})}catch(l){e.setState({valueEncodedToAttenuate:a.target.value}),e.setState({message_encoded_attenuation:"Enter a valid token !"})}},e.handleChange1=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({token:c.toVec(),valueEncoded:a.target.value,valueDecoded:c.print(),message_encoded:""})}catch(l){e.setState({valueEncoded:a.target.value}),e.setState({message_encoded:"Enter a valid token !"})}},e.handleChange_privateKey=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_privateKey:""});var n=new Uint8Array(32),c=new Uint8Array(32),l=R(a.target.value),i=r.KeyPair.fromBytes(l),s=i.publicKey();i.toBytes(n),s.toBytes(c),e.setState({privateKey:I(n),publicKey:I(c)})}catch(o){e.setState({privateKey:a.target.value}),e.setState({message_privateKey:"enter a valid key !"})}},e.handleChange_privateKey_own_verification=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_privateKey_own_verification:""});var n=new Uint8Array(32),c=new Uint8Array(32),l=R(a.target.value),i=r.KeyPair.fromBytes(l),s=i.publicKey();i.toBytes(n),s.toBytes(c),e.setState({privateKey_own_verification:I(n),publicKey_own_verification:I(c)})}catch(o){e.setState({privateKey_own_verification:a.target.value}),e.setState({message_privateKey_own_verification:"enter a valid key !"})}},e.handleChange_attenuation_privateKey=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_privateKey_attenuation:""});var n=new Uint8Array(32),c=new Uint8Array(32),l=R(a.target.value),i=r.KeyPair.fromBytes(l),s=i.publicKey();i.toBytes(n),s.toBytes(c),e.setState({attenuation_privateKey:I(n),attenuation_publicKey:I(c)})}catch(o){e.setState({attenuation_privateKey:a.target.value}),e.setState({message_privateKey_attenuation:"enter a valid key !"})}},e.handleChangee_example=function(a){var t=e.state.token_example,r=btoa(String.fromCharCode.apply(String,Object(p.a)(t)));e.setState({valueEncoded_example:r,valueDecoded_example:a.target.value})},e.handleChange1_example=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_encoded_example:""});var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({token_example:c.toVec(),valueEncoded_example:a.target.value,valueDecoded_example:c.print(),message_encoded_example:""})}catch(l){e.setState({valueEncoded_example:a.target.value}),e.setState({message_encoded_example:"Enter a valid token !"})}},e.handleChange1_verification=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_encoded_verification:""});var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({token_verification:c.toVec(),valueEncoded_verification:a.target.value,valueDecoded_verification:c.print(),message_encoded_verification:""})}catch(l){e.setState({valueEncoded_verification:a.target.value}),e.setState({message_encoded_verification:"Enter a valid token !"})}},e.handleChange2=function(a){e.setState({restrict:a.target.value})},e.handleChange3=function(a){e.setState({resource:a.target.value})},e.handleChange4=function(a){e.setState({resource_verify:a.target.value})},e.handleChange4_example=function(a){e.setState({resource_verify_example:a.target.value})},e.handleChange5_example=function(a){e.setState({restrict_verify_example:a.target.value})},e.handleChange5=function(a){e.setState({restrict_verify:a.target.value})},e.handleChange6=function(a){e.setState({seconds:a.target.value})},e.addFact=function(){var a=Object(b.a)(h.a.mark((function a(t){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState((function(a){return{fact_head_parameters:[].concat(Object(p.a)(a.fact_head_parameters),[{param:"",type:""}]),number_of_added_fact:e.state.number_of_added_fact+1}}));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.delPredicate_rule=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setState({rule_predicate_deleting:""}),a.prev=1,console.log("in predicate rule body",e.state.rule_body),0!==e.state.rule_body.length){a.next=7;break}throw SyntaxError("You don't have any predicate to delete !");case 7:if(1!==e.state.rule_body.length){a.next=11;break}e.setState({rule_body:[],rule_predicate_deleting:"Your last predicate has been deleted",rule_predicate_adding:""}),a.next=17;break;case 11:return r=Object(p.a)(e.state.rule_body.splice(e.state.rule_body.length-1,1)),console.log("in predicate rule body",r),e.setState((function(e){return{rule_body:Object(p.a)(r),rule_predicate_deleting:"Your last predicate has been deleted",rule_predicate_adding:""}})),a.next=16,new Promise((function(e){return setTimeout(e,3e3)}));case 16:console.log("last rule body",e.state.rule_body);case 17:a.next=22;break;case 19:a.prev=19,a.t0=a.catch(1),e.setState({rule_predicate_deleting:a.t0.message});case 22:case"end":return a.stop()}}),a,null,[[1,19]])})));return function(e){return a.apply(this,arguments)}}(),e.addPredicate_rule=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.setState({rule_predicate_adding:""}),a.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:console.log("in predicate rule body",e.state.rule_body),a.prev=4,r=1;case 6:if(!(r<=e.state.attenuation_ids_parameter.length)){a.next=12;break}if(""!==e.state.attenuation_ids_name&&""!==e.state.attenuation_ids_parameter[e.state.attenuation_ids_parameter.length-r].param&&""!==e.state.attenuation_ids_parameter[e.state.attenuation_ids_parameter.length-r].type){a.next=9;break}throw SyntaxError("all predicate fields must be filled out");case 9:r++,a.next=6;break;case 12:if(0!==e.state.rule_body.length){a.next=18;break}return e.setState({rule_body:[{ids_name:e.state.attenuation_ids_name,rule_ids_parameter:e.state.attenuation_ids_parameter}],attenuation_ids_name:"",attenuation_ids_parameter:[{param:"",type:""}],rule_predicate_adding:"your predicate has been added",rule_idx:e.state.rule_idx+1,hidden_msg_predicate:"Your added predicates :"}),a.next=16,new Promise((function(e){return setTimeout(e,1e3)}));case 16:a.next=19;break;case 18:e.setState((function(a){return{rule_body:[].concat(Object(p.a)(e.state.rule_body),[{ids_name:e.state.attenuation_ids_name,rule_ids_parameter:e.state.attenuation_ids_parameter}]),attenuation_ids_name:"",attenuation_ids_parameter:[{param:"",type:""}],rule_predicate_adding:"your predicate has been added",rule_idx:e.state.rule_idx+1,hidden_msg_predicate:"Your added predicates :"}}));case 19:a.next=24;break;case 21:a.prev=21,a.t0=a.catch(4),e.setState({rule_predicate_adding:a.t0.message});case 24:case"end":return a.stop()}}),a,null,[[4,21]])})));return function(e){return a.apply(this,arguments)}}(),e.delPredicate_caveat=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setState({caveat_predicate_deleting:""}),a.prev=1,console.log("in predicate caveat body",e.state.caveat_body),0!==e.state.caveat_body.length){a.next=7;break}throw SyntaxError("You don't have any predicate to delete !");case 7:if(1!==e.state.caveat_body.length){a.next=11;break}e.setState({caveat_body:[],caveat_predicate_deleting:"Your last predicate has been deleted",caveat_predicate_adding:""}),a.next=17;break;case 11:return r=Object(p.a)(e.state.caveat_body.splice(e.state.caveat_body.length-1,1)),console.log("in predicate caveat body",r),e.setState((function(e){return{caveat_body:Object(p.a)(r),caveat_predicate_deleting:"Your last predicate has been deleted",caveat_predicate_adding:""}})),a.next=16,new Promise((function(e){return setTimeout(e,3e3)}));case 16:console.log("last caveat body",e.state.caveat_body);case 17:a.next=22;break;case 19:a.prev=19,a.t0=a.catch(1),e.setState({caveat_predicate_deleting:a.t0.message});case 22:case"end":return a.stop()}}),a,null,[[1,19]])})));return function(e){return a.apply(this,arguments)}}(),e.addPredicate_caveat=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.setState({caveat_predicate_adding:""}),a.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:a.prev=3,r=0;case 5:if(!(r<e.state.attenuation_caveat_ids_parameter.length)){a.next=11;break}if(""!==e.state.attenuation_caveat_ids_name&&""!==e.state.attenuation_caveat_ids_parameter[r].param&&""!==e.state.attenuation_caveat_ids_parameter[r].type){a.next=8;break}throw SyntaxError("all predicate fields must be filled out");case 8:r++,a.next=5;break;case 11:if(0!==e.state.caveat_body.length){a.next=18;break}return e.setState({caveat_body:[{ids_name:e.state.attenuation_caveat_ids_name,caveat_ids_parameter:e.state.attenuation_caveat_ids_parameter}],attenuation_caveat_ids_name:"",attenuation_caveat_ids_parameter:[{param:"",type:""}],caveat_predicate_adding:"your predicate has been added",caveat_idx:e.state.caveat_idx+1,caveat_hidden_msg_predicate:"Your added predicates :"}),a.next=15,new Promise((function(e){return setTimeout(e,1e3)}));case 15:console.log("test",e.state.caveat_body),a.next=19;break;case 18:e.setState((function(a){return{caveat_body:[].concat(Object(p.a)(a.caveat_body),[{ids_name:e.state.caveat_ids_name,caveat_ids_parameter:e.state.caveat_ids_parameter}]),caveat_ids_name:"",caveat_ids_parameter:[{param:"",type:""}],caveat_predicate_adding:"your predicate has been added",caveat_idx:e.state.caveat_idx+1,caveat_hidden_msg_predicate:"Your added predicates :"}}));case 19:a.next=24;break;case 21:a.prev=21,a.t0=a.catch(3),e.setState({caveat_predicate_adding:a.t0.message});case 24:case"end":return a.stop()}}),a,null,[[3,21]])})));return function(e){return a.apply(this,arguments)}}(),e.addFactAttenuation=function(a){e.setState((function(e){return{attenuation_fact_head_parameters:[].concat(Object(p.a)(e.attenuation_fact_head_parameters),[{param:"",type:""}])}}))},e.addFactVerification=function(a){e.setState((function(a){return{verification_fact_head_parameters:[].concat(Object(p.a)(a.verification_fact_head_parameters),[{param:"",type:""}]),verification_number_of_added_fact:e.state.verification_number_of_added_fact+1}}))},e.addRule1=function(a){e.setState((function(a){return{ids_parameter:[].concat(Object(p.a)(a.ids_parameter),[{param:"",type:""}]),number_of_added_rules_ids:e.state.number_of_added_rules_ids+1}}))},e.addRule=function(a){e.setState((function(a){return{head_parameter:[].concat(Object(p.a)(a.head_parameter),[{param:"",type:""}]),number_of_added_rules_head:e.state.number_of_added_rules_head+1}}))},e.addRule1_attenuation=function(a){e.setState((function(a){return{attenuation_ids_parameter:[].concat(Object(p.a)(a.attenuation_ids_parameter),[{param:"",type:""}]),attenuation_number_of_added_rules_ids:e.state.attenuation_number_of_added_rules_ids+1}}))},e.addRule_attenuation=function(a){e.setState((function(a){return{attenuation_head_parameter:[].concat(Object(p.a)(a.attenuation_head_parameter),[{param:"",type:""}]),attenuation_number_of_added_rules_head:e.state.attenuation_number_of_added_rules_head+1}}))},e.addRule1_caveat=function(a){e.setState((function(a){return{caveat_ids_parameter:[].concat(Object(p.a)(a.caveat_ids_parameter),[{param:"",type:""}]),number_of_added_caveats_ids:e.state.number_of_added_caveats_ids+1}}))},e.addRule_caveat=function(a){e.setState((function(a){return{caveat_head_parameter:[].concat(Object(p.a)(a.caveat_head_parameter),[{param:"",type:""}]),number_of_added_caveats_head:e.state.number_of_added_caveats_head+1}}))},e.addCaveat1Attenuation=function(a){e.setState((function(a){return{attenuation_caveat_ids_parameter:[].concat(Object(p.a)(a.attenuation_caveat_ids_parameter),[{param:"",type:""}]),attenuation_number_of_added_caveats_ids:e.state.attenuation_number_of_added_caveats_ids+1}}))},e.addCaveatAttenuation=function(a){e.setState((function(a){return{attenuation_caveat_head_parameter:[].concat(Object(p.a)(a.attenuation_caveat_head_parameter),[{param:"",type:""}]),attenuation_number_of_added_caveats_head:e.state.attenuation_number_of_added_caveats_head+1}}))},e.addCaveat1Verification=function(a){e.setState((function(a){return{verification_caveat_ids_parameter:[].concat(Object(p.a)(a.verification_caveat_ids_parameter),[{param:"",type:""}]),verification_number_of_added_caveats_ids:e.state.verification_number_of_added_caveats_ids+1}}))},e.addCaveatVerification=function(a){e.setState((function(a){return{verification_caveat_head_parameter:[].concat(Object(p.a)(a.verification_caveat_head_parameter),[{param:"",type:""}]),verification_number_of_added_caveats_head:e.state.verification_number_of_added_caveats_head+1}}))},e.state=Object(K.a)({token:[],token_example:[],token_verification:[],tokenToAttenuate:[],valueEncoded:"",valueDecoded:"",valueEncodedToAttenuate:"",valueDecodedToAttenuate:"",valueEncoded_example:"",valueEncoded_verification:"",valueDecoded_example:"",valueDecoded_verification:"",privateKey:"",publicKey:"",privateKey_own_verification:"",publicKey_own_verification:"",attenuation_publicKey:"",attenuation_privateKey:"",restrict:"",resource:"",expiration:"",restrict_verify:"",restrict_operation_message:"",resource_prefix_message:"",token_revocation_message:"",restrict_verify_example:"",resource_verify:"",resource_verify_example:"",seconds:"",result_verification:"",gen_err:"",gen_err_empty:"",gen_err_example:"",gen_err_attenuation:"",result_verification_example:"",message_encoded_verification:"",message_encoded_example:"",message_encoded_attenuation:"",message_encoded:"",message_privateKey:"",message_privateKey_own_verification:"",message_privateKey_attenuation:"",copied:!1,attenuation_head_parameter:[{param:"",type:""}],attenuation_ids_parameter:[{param:"",type:""}],attenuation_head_name:"",attenuation_ids_name:"",attenuation_rules:[{head_parameter:[{param:"",type:""}],head_name:"",body:[]}],attenuation_rule_adding_message:"",attenuation_rule_counter:0,attenuation_number_of_added_rules_head:0,attenuation_number_of_added_rules_ids:0,rule_body:[],rule_predicate_adding:"",rule_idx:1,rule_predicate_deleting:"",attenuation_fact_head_name:"",attenuation_fact_head_parameters:[{param:"",type:""}],attenuation_facts:[{fact_head_parameters:[{param:"",type:""}],fact_head_name:""}],attenuation_fact_adding_message:"",attenuation_fact_counter:0,attenuation_number_of_added_fact:0,attenuation_caveat_head_parameter:[{param:"",type:""}],attenuation_caveat_ids_parameter:[{param:"",type:""}],attenuation_caveat_head_name:"",attenuation_caveat_ids_name:"",attenuation_caveats:[{head_parameter:[{param:"",type:""}],ids_parameter:[{param:"",type:""}],head_name:"",ids_name:""}],attenuation_caveat_adding_message:"",attenuation_caveat_counter:0,attenuation_number_of_added_caveats_head:0,attenuation_number_of_added_caveats_ids:0,caveat_body:[],caveat_predicate_adding:"",caveat_idx:1,caveat_predicate_deleting:""},"copied",!1),e}return Object(s.a)(r,[{key:"componentDidMount",value:function(){this.loadWasm()}},{key:"copy",value:function(){this.setState({copied:!0}),this.textArea.select(),document.execCommand("copy")}},{key:"render",value:function(){var e=this,a=this.state.wasm,t=void 0===a?{}:a,r=function(){var a=R(e.state.attenuation_privateKey);return t.KeyPair.fromBytes(a)},c=this.state.copied?"Copied":"Copy to clipboard",l=Object(p.a)(this.state.attenuation_head_parameter),i=Object(p.a)(this.state.attenuation_caveat_head_parameter),s=Object(p.a)(this.state.attenuation_fact_head_parameters),o=Object(p.a)(this.state.attenuation_ids_parameter),m=Object(p.a)(this.state.attenuation_caveat_ids_parameter);return n.a.createElement("div",null,n.a.createElement("div",{className:"container-fluid"},n.a.createElement("div",{className:"warning"},n.a.createElement("div",{className:"text-center"},n.a.createElement("strong",null,"Biscuitsec :"),"Learn how the biscuit token works by interacting with it. For developers, the code of the application is available on our github")),n.a.createElement("h1",{className:"mr-5 text-center"},"Token Attenuation "),n.a.createElement("br",null),n.a.createElement("div",{className:"mr-5 ml-5"},"The process of attenuation is the generation of a derived token from an already existing biscuit, for the purpose of delegating a reduced set of rights. For instance, the rental agency can restrict the token so that the car must be returned before the end of the week. Note also that the attenuation may be managed from someone that currently holds the biscuit (e.g. the driver can delegate his rights to a secod driver) but is not the initial authority (e.g. the rental agency). Therefore the attenuated token may be using a different keypair than the original token. You may refer to our documentation ",n.a.createElement("a",{href:"https://www.w3schools.com/"},"here")," to get more details and examples. "),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("h2",{className:"mr-5 ml-5"},"Keys Generation For Your Attenuated Token  "),n.a.createElement("div",{className:"ml-5 mr-5"},"In order to attenuate your token and generate a new one you must generate a new keypair"),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"Public Key"))," ",n.a.createElement("small",null," press the button to generate your keys"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea2",type:"text",readOnly:!0,value:this.state.attenuation_publicKey,rows:"2"}))),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{className:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"Private Key")),n.a.createElement("small",null," if you wanna use your private key paste it here"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",type:"text",value:this.state.attenuation_privateKey,onChange:this.handleChange_attenuation_privateKey,rows:"2"})),n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var r,n,c,l;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({message_privateKey_attenuation:""}),r=new Uint8Array(32),n=new Uint8Array(32),c=new t.KeyPair,l=c.publicKey(),c.toBytes(r),l.toBytes(n),e.setState({attenuation_privateKey:I(r),attenuation_publicKey:I(n)});case 8:case"end":return a.stop()}}),a)})))},"Generate keys"),n.a.createElement("div",null,this.state.message_privateKey_attenuation)))),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"textarea-container"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"ENCODED"))," ",n.a.createElement("small",null," paste a token to attenuate here"),n.a.createElement("textarea",{className:"form-control",ref:function(a){return e.textArea=a},id:"exampleFormControlTextarea2",type:"text",value:this.state.valueEncodedToAttenuate,onChange:this.handleChange1_attenuation,rows:"15"}),n.a.createElement("a",{onClick:function(){return e.copy()}},c)),n.a.createElement("div",null,this.state.message_encoded_attenuation)),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"DECODED")),n.a.createElement("small",null," your result"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",readOnly:!0,type:"text",value:this.state.valueDecodedToAttenuate,onChange:this.handleChangee_attenuation,rows:"15"}))))),n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("h2",{className:"mr-5 ml-5"},"Examples of Token Attenuation "),n.a.createElement("div",{className:"ml-5 mr-5"},"Here is some examples of a rental car agency delegating some rights to their clients by token attenuation"),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"Restrict Operation")),n.a.createElement("div",null,"This is an exemple of restriction on the operations that the holder of the attenuated token can do. For example if we fill out the field with open , the only opeartion the token holder can do is opening the car but not driving it."),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea2",placeholder:"open",type:"text",value:this.state.restrict,onChange:this.handleChange2,rows:"1"})),n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var r,n,c,l,i,s,o,m;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setState({restrict_operation_message:""}),a.prev=1,""!==e.state.valueEncodedToAttenuate){a.next=4;break}throw SyntaxError("You must enter the token to revocate !");case 4:if(""!==e.state.restrict){a.next=6;break}throw SyntaxError("You must fill out the field !");case 6:r=new Uint8Array(atob(e.state.valueEncodedToAttenuate).split("").map((function(e){return e.charCodeAt(0)}))),n=t.Biscuit.from(r),c=n.createBlock(),l=e.state.restrict,c.addCaveat(t.rule("operation_check",[{symbol:l}],[{name:"operation",ids:[{symbol:"ambient"},{symbol:l}]}])),i=new t.KeyPair,s=n.append(i,c),o=s.toVec(),m=btoa(String.fromCharCode.apply(String,Object(p.a)(o))),e.setState({restrict_operation_message:"Your restriction has been set"}),e.setState({tokenToAttenuate:s.toVec(),valueEncodedToAttenuate:m,valueDecodedToAttenuate:s.print()}),a.next=22;break;case 19:a.prev=19,a.t0=a.catch(1),e.setState({restrict_operation_message:a.t0.message});case 22:case"end":return a.stop()}}),a,null,[[1,19]])})))},"Restrict operation"),n.a.createElement("div",null,this.state.restrict_operation_message),n.a.createElement("br",null)," ",n.a.createElement("br",null),n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"Restrict Resource ")),n.a.createElement("div",null,' This is an exemple of a restriction on a resource set by a car rental agency , it provides to every client who rents a car an attenuated token with a restriction on the resource in order to give him the right to drive only the car which her name verify the restriction. For example if the rental agency want to rent a car which we suppose its name is "car1" we must fill out the field below by car1  '),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",placeholder:"car1",type:"text",value:this.state.resource,onChange:this.handleChange3,rows:"1"})),n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var r,n,c,l,i,s,o,m;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,e.setState({resource_prefix_message:""}),""!==e.state.valueEncodedToAttenuate){a.next=4;break}throw SyntaxError("You must enter the token to revocate !");case 4:if(""!==e.state.resource){a.next=6;break}throw SyntaxError("You must fill out the field !");case 6:r=new Uint8Array(atob(e.state.valueEncodedToAttenuate).split("").map((function(e){return e.charCodeAt(0)}))),n=t.Biscuit.from(r),c=e.state.resource,(l=n.createBlock()).addCaveat(t.constrained_rule("resource_check",[{variable:0}],[{name:"resource",ids:[{symbol:"ambient"},{variable:0}]}],[{id:0,kind:"string",operation:"prefix",data:c}])),i=new t.KeyPair,s=n.append(i,l),o=s.toVec(),m=btoa(String.fromCharCode.apply(String,Object(p.a)(o))),e.setState({resource_prefix_message:"Your restriction has been set"}),e.setState({tokenToAttenuate:s.toVec(),valueEncodedToAttenuate:m,valueDecodedToAttenuate:s.print()}),a.next=22;break;case 19:a.prev=19,a.t0=a.catch(0),e.setState({resource_prefix_message:a.t0.message});case 22:case"end":return a.stop()}}),a,null,[[0,19]])})))},"Restrict resource"),n.a.createElement("div",null,this.state.resource_prefix_message)),n.a.createElement("br",null),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"Token Expiration")),n.a.createElement("div",null,"We can also attenuate a token for a defined moment by specifying how much time the token will be valid. If we fill out the field with 3600 (second) the token we be usable for only one hour so for the example of a rental car agency the car will be rented only one hour"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",placeholder:"30 (seconds)",type:"text",value:this.state.seconds,onChange:this.handleChange6,rows:"1"})),n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var r,n,c,l,i,s,o,m,d;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setState({token_revocation_message:""}),a.prev=1,""!==e.state.valueEncodedToAttenuate){a.next=4;break}throw SyntaxError("You must enter the token to revocate !");case 4:if(""!==e.state.seconds){a.next=6;break}throw SyntaxError("You must fill out the field !");case 6:if(!0!==isNaN(e.state.seconds)){a.next=8;break}throw SyntaxError("You must enter an integer ");case 8:r=new Uint8Array(atob(e.state.valueEncodedToAttenuate).split("").map((function(e){return e.charCodeAt(0)}))),n=t.Biscuit.from(r),c=parseInt(e.state.seconds),l=parseInt((new Date((new Date).getTime()+1e3*c)/1e3).toFixed(0)),console.log("expires at "+l),(i=n.createBlock()).addCaveat(t.constrained_rule("expiration_check",[{variable:0}],[{name:"time",ids:[{symbol:"ambient"},{variable:0}]}],[{id:0,kind:"date",operation:"<=",data:l}])),s=new t.KeyPair,o=n.append(s,i),m=o.toVec(),d=btoa(String.fromCharCode.apply(String,Object(p.a)(m))),e.setState({tokenToAttenuate:o.toVec(),valueEncodedToAttenuate:d,valueDecodedToAttenuate:o.print()}),e.setState({token_revocation_message:"Your expiration time has been set"}),a.next=26;break;case 23:a.prev=23,a.t0=a.catch(1),e.setState({token_revocation_message:a.t0.message});case 26:case"end":return a.stop()}}),a,null,[[1,23]])})))},"Time before expiration"),n.a.createElement("div",null,this.state.token_revocation_message)))),n.a.createElement("br",null),n.a.createElement("h2",{className:"mr-5 ml-5"},"Set your own attenuation  "),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10",onChange:this.handleChange},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-3 ml-5 mr-5"},n.a.createElement("h2",null,"Add a new rule"))),n.a.createElement("div",{className:"ml-5 mr-5"},"The rule has the same structure as the authority rule and it will be applied on the facts of the attenuated token.",n.a.createElement("br",null),n.a.createElement("strong",null,"Note : if the rule generates an ambient or an authority fact it will automatically fail in the verification process. ")),n.a.createElement("br",null),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h3",null,"Header")),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 mr-2 ml-5 "},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"head name ")),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{variant:"outlined",type:"text",value:this.state.attenuation_head_name,className:"attenuation_head_name form-control",id:"head-name",row:"1"}))),n.a.createElement(F,{rules:l}),n.a.createElement("div",{className:"col-0 mr-3 "},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement(w.a,{onClick:this.addRule_attenuation},n.a.createElement(S.a,null))))),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h3",null,"Body")),n.a.createElement("h5",{className:"ml-5"},this.state.hidden_msg_predicate),n.a.createElement(C,{predicates:this.state.rule_body}),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"pid".concat(this.state.rule_idx," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{id:"outlined-basic",label:"ids",variant:"outlined",type:"text",value:this.state.attenuation_ids_name,className:"attenuation_ids_name form-control"}))),n.a.createElement(D,{rules:o,rule_idx:this.state.rule_idx}),n.a.createElement("div",{className:"col-0 mr-2"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("h3",null,n.a.createElement(w.a,{onClick:this.addRule1_attenuation},n.a.createElement(S.a,null))))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.addPredicate_rule},"add predicate"),n.a.createElement("div",null,this.state.rule_predicate_adding))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.delPredicate_rule},"Delete last predicate"),n.a.createElement("div",null,this.state.rule_predicate_deleting)))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-0 "},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.prev=0,e.setState({attenuation_rule_adding_message:""}),t=0;case 3:if(!(t<e.state.attenuation_head_parameter.length)){a.next=9;break}if(""!==e.state.attenuation_head_name&&""!==e.state.attenuation_head_parameter[t].param&&""!==e.state.attenuation_head_parameter[t].type){a.next=6;break}throw SyntaxError("Incomplete data: all fields must be filled out");case 6:t++,a.next=3;break;case 9:if(0!==e.state.attenuation_rule_counter){a.next=15;break}if(0!==e.state.rule_body.length){a.next=12;break}throw SyntaxError("You must add at least one predicate !");case 12:e.setState({attenuation_rules:[{head_parameter:e.state.attenuation_head_parameter,head_name:e.state.attenuation_head_name,body:e.state.rule_body}]}),a.next=18;break;case 15:if(0!==e.state.rule_body.length){a.next=17;break}throw SyntaxError("You must add at least one predicate !");case 17:e.setState((function(a){return{attenuation_rules:[].concat(Object(p.a)(a.attenuation_rules),[{head_parameter:e.state.attenuation_head_parameter,head_name:e.state.attenuation_head_name,body:e.state.rule_body}])}}));case 18:return e.setState({attenuation_rule_adding_message:"Your new rule has been added"}),e.setState({attenuation_rule_counter:e.state.attenuation_rule_counter+1}),e.setState({attenuation_head_parameter:[{param:"",type:""}],attenuation_head_name:"",rule_idx:1,caveat_predicate_adding:"",body:[],rule_body:[]}),a.next=23,new Promise((function(e){return setTimeout(e,1e3)}));case 23:a.next=28;break;case 25:a.prev=25,a.t0=a.catch(0),e.setState({attenuation_rule_adding_message:a.t0.message});case 28:case"end":return a.stop()}}),a,null,[[0,25]])})))},"Add rule")),n.a.createElement("div",{className:"col-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({attenuation_head_parameter:[{param:"",type:""}],attenuation_ids_parameter:[{param:"",type:""}],attenuation_head_name:"",attenuation_ids_name:"",attenuation_rule_adding_message:"",attenuation_rule_counter:0,attenuation_number_of_added_rules_head:0,attenuation_number_of_added_rules_ids:0,rule_body:[],rule_predicate_adding:"",rule_idx:1,rule_predicate_deleting:""});case 1:case"end":return a.stop()}}),a)})))},"Reset rule")))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-2 mr-2 ml-5 "},n.a.createElement("div",{id:"attenuation_rule_adding_result"},this.state.attenuation_rule_adding_message))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-3 ml-5"},n.a.createElement("h2",null,"Add a new fact"))),n.a.createElement("div",{className:"ml-5 mr-5"},"The fact in the attenuated token has the same structure as the one explained in the genration page but the only difference is the fact here hold the rights of the attenuated token.",n.a.createElement("br",null),n.a.createElement("strong",null,"Note : the fact cannot contain the authority or ambient symbols otherwise the verification will fail")),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 mr-2 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"fact name ")),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{variant:"outlined",type:"text",value:this.state.attenuation_fact_head_name,className:"attenuation_fact_head_name form-control",id:"fact-head-name",row:"1"}))),n.a.createElement(P,{rules:s}),n.a.createElement("div",{className:"col-0 mr-3 "},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement(w.a,{onClick:this.addFactAttenuation},n.a.createElement(S.a,null))))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-0 "},n.a.createElement("button",{className:"col-12",onClick:Object(b.a)(h.a.mark((function a(){var t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.prev=0,e.setState({attenuation_fact_adding_message:""}),t=0;case 3:if(!(t<e.state.attenuation_fact_head_parameters.length)){a.next=9;break}if(""!==e.state.attenuation_fact_head_name&&""!==e.state.attenuation_fact_head_parameters[t].param&&""!==e.state.attenuation_fact_head_parameters[t].type){a.next=6;break}throw SyntaxError("Incomplete data: all fields must be filled out");case 6:t++,a.next=3;break;case 9:0===e.state.attenuation_fact_counter?e.setState({attenuation_facts:[{fact_head_parameters:e.state.attenuation_fact_head_parameters,fact_head_name:e.state.attenuation_fact_head_name}]}):e.setState((function(a){return{attenuation_facts:[].concat(Object(p.a)(a.attenuation_facts),[{fact_head_parameters:e.state.attenuation_fact_head_parameters,fact_head_name:e.state.attenuation_fact_head_name}])}})),e.setState({attenuation_fact_head_name:"",attenuation_fact_head_parameters:[{param:"",type:""}]}),e.setState({attenuation_fact_adding_message:"Your new fact has been added"}),e.setState({attenuation_fact_counter:e.state.attenuation_fact_counter+1}),a.next=18;break;case 15:a.prev=15,a.t0=a.catch(0),e.setState({attenuation_fact_adding_message:a.t0.message});case 18:case"end":return a.stop()}}),a,null,[[0,15]])})))},"Add fact")),n.a.createElement("div",{className:"col-2 ml-3"},n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({attenuation_fact_head_name:"",attenuation_fact_head_parameters:[{param:"",type:""}],attenuation_fact_adding_message:""});case 1:case"end":return a.stop()}}),a)})))},"Reset fact")))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-2 mr-2 ml-5"},n.a.createElement("div",{id:"fact_adding_result"},this.state.attenuation_fact_adding_message))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-3 ml-5 mr-5"},n.a.createElement("h2",null,"Add a new caveat"))),n.a.createElement("div",{className:"ml-5 mr-5"},"Caveats are logic queries evaluating conditions on authority and ambient facts. To validate an operation, all of a token's caveats must succeed.In the attenuated token the caveat are used to set conditions on the rights that the holder of the attenuated token can have. "),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h3",null,"Header")),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 mr-2 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"head name ")),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{variant:"outlined",type:"text",value:this.state.attenuation_caveat_head_name,className:"attenuation_caveat_head_name form-control",id:"head-name",row:"1"}))),n.a.createElement(Y,{rules:i,type:"text"}),n.a.createElement("div",{className:"col-0 mr-3 "},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement(w.a,{onClick:this.addCaveatAttenuation},n.a.createElement(S.a,null))))),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h3",null,"Body")),n.a.createElement("h5",{className:"ml-5"},this.state.caveat_hidden_msg_predicate),n.a.createElement(O,{predicates:this.state.caveat_body}),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"pid".concat(this.state.caveat_idx))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{id:"outlined-basic",label:"ids",variant:"outlined",type:"text",value:this.state.attenuation_caveat_ids_name,className:"attenuation_caveat_ids_name form-control"}))),n.a.createElement(B,{rules:m,caveat_idx:this.state.caveat_idx}),n.a.createElement("div",{className:"col-0 mr-2"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("h3",null,n.a.createElement(w.a,{onClick:this.addCaveat1Attenuation},n.a.createElement(S.a,null))))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.addPredicate_caveat},"add predicate"),n.a.createElement("div",null,this.state.caveat_predicate_adding))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.delPredicate_caveat},"Delete last predicate"),n.a.createElement("div",null,this.state.caveat_predicate_deleting)))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("br",null),n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-0 ml-1 "},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.prev=0,e.setState({attenuation_caveat_adding_message:""}),t=0;case 3:if(!(t<e.state.attenuation_caveat_head_parameter.length)){a.next=9;break}if(""!==e.state.attenuation_caveat_head_name&&""!==e.state.attenuation_caveat_head_parameter[t].param&&""!==e.state.attenuation_caveat_head_parameter[t].type){a.next=6;break}throw SyntaxError("Incomplete data: all fields must be filled out");case 6:t++,a.next=3;break;case 9:if(0!==e.state.attenuation_caveat_counter){a.next=15;break}if(0!==e.state.caveat_body.length){a.next=12;break}throw SyntaxError("You must add at least one predicate !");case 12:e.setState({attenuation_caveats:[{head_parameter:e.state.attenuation_caveat_head_parameter,head_name:e.state.attenuation_caveat_head_name,body:e.state.caveat_body}]}),a.next=18;break;case 15:if(0!==e.state.caveat_body.length){a.next=17;break}throw SyntaxError("You must add at least one predicate !");case 17:e.setState((function(a){return{attenuation_caveats:[].concat(Object(p.a)(a.attenuation_caveats),[{head_parameter:e.state.attenuation_caveat_head_parameter,head_name:e.state.attenuation_caveat_head_name,body:e.state.caveat_body}])}}));case 18:e.setState({attenuation_caveat_adding_message:"Your new caveat has been added"}),e.setState({attenuation_caveat_counter:e.state.attenuation_caveat_counter+1}),e.setState({attenuation_caveat_head_name:"",attenuation_caveat_head_parameter:[{param:"",type:""}],caveat_idx:1,rule_predicate_adding:"",body:[],caveat_body:[]}),a.next=26;break;case 23:a.prev=23,a.t0=a.catch(0),e.setState({attenuation_caveat_adding_message:a.t0.message});case 26:case"end":return a.stop()}}),a,null,[[0,23]])})))},"Add caveat")),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({attenuation_caveat_head_parameter:[{param:"",type:""}],attenuation_caveat_ids_parameter:[{param:"",type:""}],attenuation_caveat_head_name:"",attenuation_caveat_ids_name:"",attenuation_caveat_adding_message:"",attenuation_number_of_added_caveats_head:0,attenuation_number_of_added_caveats_ids:0,caveat_body:[],caveat_predicate_adding:"",caveat_idx:1,caveat_predicate_deleting:""});case 1:case"end":return a.stop()}}),a)})))},"Reset caveat")))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-2 mr-2 "},n.a.createElement("div",{id:"attenuation_caveat_adding_result"},this.state.attenuation_caveat_adding_message))),n.a.createElement("br",null)," ",n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-4"}),n.a.createElement("div",{className:"col-2 ml-5"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var n,c,l,i,s,o,m,d,_,u,v,f,b,E,g,y,x,N,w,k,S,C,O,j,T,A,K,F,D,P,Y,B,I,R,V;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setState({gen_err_attenuation:""}),a.prev=1,""!==e.state.valueEncodedToAttenuate){a.next=4;break}throw SyntaxError("You must enter the token to attenuate !");case 4:if(n=new Uint8Array(atob(e.state.valueEncodedToAttenuate).split("").map((function(e){return e.charCodeAt(0)}))),c=t.Biscuit.from(n),l=c.createBlock(),e.state.attenuation_rule_counter>0)for(i=0;i<e.state.attenuation_rules.length;i++){for(console.log("step {}",i),s=Object(p.a)(e.state.attenuation_rules[i].head_parameter),o=[],m=0;m<s.length;m++)"variable"===s[m].type?o=[].concat(Object(p.a)(o),[{variable:parseInt(s[m].param)}]):"string"===s[m].type?o=[].concat(Object(p.a)(o),[{string:s[m].param}]):"symbol"===s[m].type?o=[].concat(Object(p.a)(o),[{symbol:s[m].param}]):"integer"===s[m].type?o=[].concat(Object(p.a)(o),[{integer:parseInt(s[m].param)}]):"date"===s[m].type&&(o=[].concat(Object(p.a)(o),[{date:Date.parse(s[m].param)}]));for(d=Object(p.a)(e.state.attenuation_rules[i].body),console.log("last test body rule",e.state.attenuation_rules[i].body),_=[],u=0;u<d.length;u++){for(v=d[u].ids_name,f=Object(p.a)(d[u].rule_ids_parameter),b=[],E=0;E<f.length;E++)"variable"===f[E].type?b=[].concat(Object(p.a)(b),[{variable:parseInt(f[E].param)}]):"string"===f[E].type?b=[].concat(Object(p.a)(b),[{string:f[E].param}]):"symbol"===f[E].type?b=[].concat(Object(p.a)(b),[{symbol:f[E].param}]):"integer"===f[E].type?b=[].concat(Object(p.a)(b),[{integer:parseInt(f[E].param)}]):"date"===f[E].type&&(b=[].concat(Object(p.a)(b),[{date:Date.parse(f[E].param)}]));_=[].concat(Object(p.a)(_),[{name:v,ids:b}])}console.log("body_for_rule",_),g=t.rule(e.state.attenuation_rules[i].head_name,o,_),l.addRule(g)}if(console.log("fact counter :",e.state.attenuation_fact_counter),e.state.attenuation_fact_counter>0)for(y=0;y<e.state.attenuation_facts.length;y++){for(x=Object(p.a)(e.state.attenuation_facts[y].fact_head_parameters),N=[],w=0;w<x.length;w++)"variable"===x[w].type?N=[].concat(Object(p.a)(N),[{variable:parseInt(x[w].param)}]):"string"===x[w].type?N=[].concat(Object(p.a)(N),[{string:x[w].param}]):"symbol"===x[w].type?N=[].concat(Object(p.a)(N),[{symbol:x[w].param}]):"integer"===x[w].type?N=[].concat(Object(p.a)(N),[{integer:parseInt(x[w].param)}]):"date "===x[w].type&&(N=[].concat(Object(p.a)(N),[{date:Date.parse(x[w].param)}]));k=t.fact(e.state.attenuation_facts[y].fact_head_name,N),l.addFact(k)}if(console.log("caveat counter :",e.state.attenuation_caveat_counter),e.state.attenuation_caveat_counter>0)for(S=0;S<e.state.attenuation_caveats.length;S++){for(console.log("step {}",S),C=Object(p.a)(e.state.attenuation_caveats[S].head_parameter),O=[],j=0;j<C.length;j++)"variable"===C[j].type?O=[].concat(Object(p.a)(O),[{variable:parseInt(C[j].param)}]):"string"===C[j].type?O=[].concat(Object(p.a)(O),[{string:C[j].param}]):"symbol"===C[j].type?O=[].concat(Object(p.a)(O),[{symbol:C[j].param}]):"integer"===C[j].type?O=[].concat(Object(p.a)(O),[{integer:parseInt(C[j].param)}]):"date"===C[j].type&&(O=[].concat(Object(p.a)(O),[{date:Date.parse(C[j].param)}]));for(T=Object(p.a)(e.state.attenuation_caveats[S].body),A=[],K=0;K<T.length;K++){for(F=T[K].ids_name,D=Object(p.a)(T[K].caveat_ids_parameter),P=[],Y=0;Y<D.length;Y++)"variable"===D[Y].type?P=[].concat(Object(p.a)(P),[{variable:parseInt(D[Y].param)}]):"string"===D[Y].type?P=[].concat(Object(p.a)(P),[{string:D[Y].param}]):"symbol"===D[Y].type?P=[].concat(Object(p.a)(P),[{symbol:D[Y].param}]):"date"===D[Y].type?P=[].concat(Object(p.a)(P),[{date:Date.parse(D[Y].param)}]):"integer"===D[Y].type&&(P=[].concat(Object(p.a)(P),[{integer:parseInt(D[Y].param)}]));A=[].concat(Object(p.a)(A),[{name:F,ids:P}])}console.log("body_for_rule",A),B=t.rule(e.state.attenuation_caveats[S].head_name,O,A),l.addCaveat(B)}if(""!==e.state.attenuation_privateKey){a.next=14;break}throw SyntaxError("Your must enter or generate your private key before generating the token");case 14:I=c.append(r(),l),R=I.toVec(),V=btoa(String.fromCharCode.apply(String,Object(p.a)(R))),e.setState({tokenToAttenuate:I.toVec(),valueEncodedToAttenuate:V,valueDecodedToAttenuate:I.print()}),e.setState({attenuation_head_parameter:[{param:"",type:""}],attenuation_ids_parameter:[{param:"",type:""}],attenuation_head_name:"",attenuation_ids_name:"",attenuation_rules:[{head_parameter:[{param:"",type:""}],head_name:"",body:[]}],attenuation_rule_adding_message:"",attenuation_rule_counter:0,attenuation_number_of_added_rules_head:0,attenuation_number_of_added_rules_ids:0,rule_body:[],rule_predicate_adding:"",rule_idx:1,hidden_msg_predicate:"",attenuation_fact_head_name:"",attenuation_fact_head_parameters:[{param:"",type:""}],attenuation_facts:[{fact_head_parameters:[{param:"",type:""}],fact_head_name:""}],attenuation_fact_adding_message:"",attenuation_fact_counter:0,attenuation_number_of_added_fact:0,attenuation_caveat_head_parameter:[{param:"",type:""}],attenuation_caveat_ids_parameter:[{param:"",type:""}],attenuation_caveat_head_name:"",attenuation_caveat_ids_name:"",attenuation_caveats:[{head_parameter:[{param:"",type:""}],ids_parameter:[{param:"",type:""}],head_name:"",ids_name:""}],attenuation_caveat_adding_message:"",attenuation_caveat_counter:0,attenuation_number_of_added_caveats_head:0,attenuation_number_of_added_caveats_ids:0,caveat_body:[],caveat_predicate_adding:"",caveat_idx:1,caveat_hidden_msg_predicate:""}),a.next=24;break;case 21:a.prev=21,a.t0=a.catch(1),e.setState({gen_err_attenuation:a.t0.message});case 24:case"end":return a.stop()}}),a,null,[[1,21]])})))}," Generate your new token "),n.a.createElement("div",null,this.state.gen_err_attenuation))))))}}]),r}(n.a.Component),U=function(e){return e.rules.map((function(a,t){var r="Verification_caveat_ids_parameter-".concat(t),c="Verification_caveat_ids_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"p".concat(e.caveat_idx,"_").concat(t+1," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"ids's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"verification_caveat_ids_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"verification_caveat_ids_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},W=function(e){return e.rules.map((function(a,t){var r="Verification_caveat_head_parameter-".concat(t),c="Verification_caveat_head_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"parameter h".concat(t+1," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"head's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"verification_caveat_head_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"verification_caveat_head_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},G=function(e){return e.rules.map((function(a,t){var r="verification_fact_parameter-".concat(t),c="verification_fact_parameter_type-".concat(t);return n.a.createElement("div",{key:t,className:"col-3"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-6 mr-3"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"parameter h".concat(t+1," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{label:"fact's parameter",variant:"outlined",type:"text",name:r,"data-id":t,id:r,value:e.rules[t].param,className:"verification_fact_parameter form-control"}))),n.a.createElement("div",{className:"col-0 mr-2 ml-2"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"type ")),n.a.createElement("div",{className:"row"},n.a.createElement("select",{type:"text",name:c,"data-id":t,id:c,value:e.rules[t].type,className:"verification_fact_parameter_type form-control"},n.a.createElement("option",{selected:!0,disabled:!0,hidden:!0,value:""},"select type"),n.a.createElement("option",{value:"string"},"string"),n.a.createElement("option",{value:"variable"},"variable"),n.a.createElement("option",{value:"symbol"},"symbol"),n.a.createElement("option",{value:"date"},"date"),n.a.createElement("option",{value:"integer"},"integer"))))))}))},M=function(e){return e.reduce((function(e,a){return e+a.toString(16).padStart(2,"0")}),"")},H=function(e){return new Uint8Array(e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})))},L=function(e){Object(o.a)(r,e);var a=Object(m.a)(r);function r(){var e;return Object(i.a)(this,r),(e=a.call(this)).loadWasm=Object(b.a)(h.a.mark((function a(){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.e(0).then(t.bind(null,285));case 3:r=a.sent,e.setState({wasm:r}),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.error("Unexpected error in loadWasm. [Message: ".concat(a.t0.message,"]"));case 10:case"end":return a.stop()}}),a,null,[[0,7]])}))),e.handleChange=function(a){if(["verification_caveat_head_parameter form-control"].includes(a.target.className)){var t=Object(p.a)(e.state.verification_caveat_head_parameter);t[a.target.dataset.id].param=a.target.value,e.setState({verification_caveat_head_parameter:t},(function(){return console.log(e.state.verification_caveat_head_parameter)}))}else if(["verification_caveat_ids_parameter form-control"].includes(a.target.className)){var r=Object(p.a)(e.state.verification_caveat_ids_parameter);r[a.target.dataset.id].param=a.target.value,e.setState({verification_caveat_ids_parameter:r},(function(){return console.log(e.state.verification_caveat_ids_parameter)}))}else if(["verification_caveat_ids_parameter_type form-control"].includes(a.target.className)){var n=Object(p.a)(e.state.verification_caveat_ids_parameter);n[a.target.dataset.id].type=a.target.value,e.setState({verification_caveat_ids_parameter:n},(function(){return console.log(e.state.verification_caveat_ids_parameter)}))}else if(["verification_caveat_head_parameter_type form-control"].includes(a.target.className)){var c=Object(p.a)(e.state.verification_caveat_head_parameter);c[a.target.dataset.id].type=a.target.value,e.setState({verification_caveat_head_parameter:c},(function(){return console.log(e.state.verification_caveat_head_parameter)}))}else if(["verification_caveat_head_name form-control"].includes(a.target.className))e.setState({verification_caveat_head_name:a.target.value},(function(){return console.log(e.state.verification_caveat_head_name)}));else if(["verification_caveat_ids_name form-control"].includes(a.target.className))e.setState({verification_caveat_ids_name:a.target.value},(function(){return console.log(e.state.verification_caveat_ids_name)}));else if(["verification_fact_head_name form-control"].includes(a.target.className))e.setState({verification_fact_head_name:a.target.value},(function(){return console.log(e.state.verification_fact_head_name)}));else if(["verification_fact_parameter form-control"].includes(a.target.className)){var l=Object(p.a)(e.state.verification_fact_head_parameters);l[a.target.dataset.id].param=a.target.value,e.setState({verification_fact_head_parameters:l},(function(){return console.log(e.state.verification_fact_head_parameters)}))}else if(["verification_fact_parameter_type form-control"].includes(a.target.className)){var i=Object(p.a)(e.state.verification_fact_head_parameters);i[a.target.dataset.id].type=a.target.value,e.setState({verification_fact_head_parameters:i},(function(){return console.log(e.state.verification_fact_head_parameters)}))}},e.handleChangee=function(a){var t=e.state.token,r=btoa(String.fromCharCode.apply(String,Object(p.a)(t)));e.setState({valueEncoded:r,valueDecoded:a.target.value})},e.handleChange1=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({token:c.toVec(),valueEncoded:a.target.value,valueDecoded:c.print(),message_encoded:""})}catch(l){e.setState({valueEncoded:a.target.value}),e.setState({message_encoded:"Enter a valid token !"})}},e.handleChange_privateKey_own_verification=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_privateKey_own_verification:""});var n=new Uint8Array(32),c=new Uint8Array(32),l=H(a.target.value),i=r.KeyPair.fromBytes(l),s=i.publicKey();i.toBytes(n),s.toBytes(c),e.setState({privateKey_own_verification:M(n),publicKey_own_verification:M(c)})}catch(o){e.setState({privateKey_own_verification:a.target.value}),e.setState({message_privateKey_own_verification:"enter a valid key !"})}},e.handleChange1_verification=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_encoded_verification:""});var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({token_verification:c.toVec(),valueEncoded_verification:a.target.value,valueDecoded_verification:c.print(),message_encoded_verification:""})}catch(l){e.setState({valueEncoded_verification:a.target.value}),e.setState({message_encoded_verification:"Enter a valid token !"})}},e.addFactVerification=function(a){e.setState((function(a){return{verification_fact_head_parameters:[].concat(Object(p.a)(a.verification_fact_head_parameters),[{param:"",type:""}]),verification_number_of_added_fact:e.state.verification_number_of_added_fact+1}}))},e.addCaveatAttenuation=function(a){e.setState((function(a){return{attenuation_caveat_head_parameter:[].concat(Object(p.a)(a.attenuation_caveat_head_parameter),[{param:"",type:""}]),attenuation_number_of_added_caveats_head:e.state.attenuation_number_of_added_caveats_head+1}}))},e.addCaveat1Verification=function(a){e.setState((function(a){return{verification_caveat_ids_parameter:[].concat(Object(p.a)(a.verification_caveat_ids_parameter),[{param:"",type:""}]),verification_number_of_added_caveats_ids:e.state.verification_number_of_added_caveats_ids+1}}))},e.delPredicate_caveat=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(e.setState({caveat_predicate_deleting:""}),a.prev=1,console.log("in predicate caveat body",e.state.caveat_body),0!==e.state.caveat_body.length){a.next=7;break}throw SyntaxError("You don't have any predicate to delete !");case 7:if(1!==e.state.caveat_body.length){a.next=11;break}e.setState({caveat_body:[],caveat_predicate_deleting:"Your last predicate has been deleted",caveat_predicate_adding:""}),a.next=17;break;case 11:return r=Object(p.a)(e.state.caveat_body.splice(e.state.caveat_body.length-1,1)),console.log("in predicate caveat body",r),e.setState((function(e){return{caveat_body:Object(p.a)(r),caveat_predicate_deleting:"Your last predicate has been deleted",caveat_predicate_adding:""}})),a.next=16,new Promise((function(e){return setTimeout(e,3e3)}));case 16:console.log("last caveat body",e.state.caveat_body);case 17:a.next=22;break;case 19:a.prev=19,a.t0=a.catch(1),e.setState({caveat_predicate_deleting:a.t0.message});case 22:case"end":return a.stop()}}),a,null,[[1,19]])})));return function(e){return a.apply(this,arguments)}}(),e.addPredicate_caveat=function(){var a=Object(b.a)(h.a.mark((function a(t){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.setState({caveat_predicate_adding:""}),a.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:a.prev=3,r=1;case 5:if(!(r<e.state.verification_caveat_ids_parameter.length)){a.next=11;break}if(""!==e.state.verification_caveat_ids_name&&""!==e.state.verification_caveat_ids_parameter[r].param&&""!==e.state.verification_caveat_ids_parameter[r].type){a.next=8;break}throw SyntaxError("all predicate fields must be filled out");case 8:r++,a.next=5;break;case 11:if(0!==e.state.caveat_body.length){a.next=18;break}return e.setState({caveat_body:[{ids_name:e.state.verification_caveat_ids_name,caveat_ids_parameter:e.state.verification_caveat_ids_parameter}],verification_caveat_ids_name:"",verification_caveat_ids_parameter:[{param:"",type:""}],caveat_predicate_adding:"your predicate has been added",caveat_idx:e.state.caveat_idx+1,caveat_hidden_msg_predicate:"Your added predicates :"}),a.next=15,new Promise((function(e){return setTimeout(e,1e3)}));case 15:console.log("caveat body",e.state.caveat_body),a.next=19;break;case 18:e.setState((function(a){return{caveat_body:[].concat(Object(p.a)(a.caveat_body),[{ids_name:e.state.verification_caveat_ids_name,caveat_ids_parameter:e.state.verification_caveat_ids_parameter}]),caveat_ids_name:"",caveat_ids_parameter:[{param:"",type:""}],caveat_predicate_adding:"your predicate has been added",caveat_idx:e.state.caveat_idx+1,caveat_hidden_msg_predicate:"Your added predicates :"}}));case 19:a.next=24;break;case 21:a.prev=21,a.t0=a.catch(3),e.setState({caveat_predicate_adding:a.t0.message});case 24:case"end":return a.stop()}}),a,null,[[3,21]])})));return function(e){return a.apply(this,arguments)}}(),e.handleChange4=function(a){e.setState({resource_verify:a.target.value})},e.handleChange4_example=function(a){e.setState({resource_verify_example:a.target.value})},e.handleChange5_example=function(a){e.setState({restrict_verify_example:a.target.value})},e.handleChange5=function(a){e.setState({restrict_verify:a.target.value})},e.addCaveatVerification=function(a){e.setState((function(a){return{verification_caveat_head_parameter:[].concat(Object(p.a)(a.verification_caveat_head_parameter),[{param:"",type:""}]),verification_number_of_added_caveats_head:e.state.verification_number_of_added_caveats_head+1}}))},e.state={token:[],token_example:[],token_verification:[],tokenToAttenuate:[],valueEncoded:"",valueDecoded:"",valueEncodedToAttenuate:"",valueDecodedToAttenuate:"",valueEncoded_example:"",valueEncoded_verification:"",valueDecoded_example:"",valueDecoded_verification:"",privateKey:"",publicKey:"",privateKey_own_verification:"",publicKey_own_verification:"",attenuation_publicKey:"",attenuation_privateKey:"",restrict:"",resource:"",expiration:"",restrict_verify:"",restrict_operation_message:"",resource_prefix_message:"",token_revocation_message:"",restrict_verify_example:"",resource_verify:"",resource_verify_example:"",seconds:"",result_verification:"",gen_err:"",gen_err_empty:"",gen_err_example:"",gen_err_attenuation:"",result_verification_example:"",message_encoded_verification:"",message_encoded_example:"",message_encoded_attenuation:"",message_encoded:"",message_privateKey:"",message_privateKey_own_verification:"",message_privateKey_attenuation:"",copied:!1,verification_fact_head_name:"",verification_fact_head_parameters:[{param:"",type:""}],verification_facts:[{fact_head_parameters:[{param:"",type:""}],fact_head_name:""}],verification_fact_adding_message:"",verification_fact_counter:0,verification_number_of_added_fact:0,verification_caveat_head_parameter:[{param:"",type:""}],verification_caveat_ids_parameter:[{param:"",type:""}],verification_caveat_head_name:"",verification_caveat_ids_name:"",verification_caveats:[{head_parameter:[{param:"",type:""}],head_name:"",body:[]}],verification_caveat_adding_message:"",verification_caveat_counter:0,verification_number_of_added_caveats_head:0,verification_number_of_added_caveats_ids:0,caveat_body:[],caveat_predicate_adding:"",caveat_idx:1,caveat_hidden_msg_predicate:"",caveat_predicate_deleting:""},e}return Object(s.a)(r,[{key:"componentDidMount",value:function(){this.loadWasm()}},{key:"copy",value:function(){this.setState({copied:!0}),this.textArea.select(),document.execCommand("copy")}},{key:"render",value:function(){var e=this,a=this.state.wasm,t=void 0===a?{}:a,r=this.state.copied?"Copied":"Copy to clipboard",c=Object(p.a)(this.state.verification_caveat_head_parameter),l=Object(p.a)(this.state.verification_fact_head_parameters),i=Object(p.a)(this.state.verification_caveat_ids_parameter);return n.a.createElement("div",null,n.a.createElement("div",{className:"container-fluid"},n.a.createElement("div",{className:"warning"},n.a.createElement("div",{className:"text-center"},n.a.createElement("strong",null,"Biscuitsec :"),"Learn how the biscuit token works by interacting with it. For developers, the code of the application is available on our github")),n.a.createElement("h1",{className:"mr-5 text-center"},"Token Verification "),n.a.createElement("br",null),n.a.createElement("div",{className:"ml-5"},"In the verification process :",n.a.createElement("ul",null,n.a.createElement("li",null,"Ambient data like operation, resource, fact , etc must be added to the verifier in order to generate new facts"),n.a.createElement("li",null,"You can add a rule to verify on the token"))),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"Public Key")),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea2",type:"text",readOnly:!0,value:this.state.publicKey_own_verification,rows:"2"}))),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{className:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"Private Key")),n.a.createElement("small",null," paste your private key here"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",type:"text",value:this.state.privateKey_own_verification,onChange:this.handleChange_privateKey_own_verification,rows:"2"})),n.a.createElement("div",null,this.state.message_privateKey_own_verification)))),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"textarea-container"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"ENCODED")),n.a.createElement("small",null," paste a token to verify here"),n.a.createElement("textarea",{ref:function(a){return e.textArea=a},className:"form-control",id:"exampleFormControlTextarea2",type:"text",value:this.state.valueEncoded_verification,onChange:this.handleChange1_verification,rows:"15"}),n.a.createElement("a",{onClick:function(){return e.copy()}},r)),n.a.createElement("div",null,this.state.message_encoded_verification)),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"DECODED")),n.a.createElement("small",null," your result"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",readOnly:!0,type:"text",value:this.state.valueDecoded_verification,rows:"15"}))))),n.a.createElement("br",null),n.a.createElement("h2",{className:"mr-5 ml-5"},"Example of Token Verification "),n.a.createElement("div",{className:"mr-5 ml-5"},"This example illustrates a token verification , the verifier will verify if the user has the right to do the operation on the resource he specified. "),n.a.createElement("div",{className:"mr-5 ml-5"},"For more details click ",n.a.createElement("a",{href:"https://www.w3schools.com/"},"here")),n.a.createElement("div",{className:"container-fluid mt-10"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"Resource")),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea2",type:"text",value:this.state.resource_verify_example,placeholder:"/apps/123",onChange:this.handleChange4_example,rows:"1"}))),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{className:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"Operation to verify on the resource")),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",type:"text",value:this.state.restrict_verify_example,placeholder:"read",onChange:this.handleChange5_example,rows:"1"})),n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var r,n,c,l,i;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,""!==e.state.valueEncoded_verification){a.next=5;break}throw SyntaxError("You must enter the token to verify");case 5:if(""!==e.state.privateKey_own_verification){a.next=7;break}throw SyntaxError("You must enter your private key");case 7:r=new Uint8Array(atob(e.state.valueEncoded_verification).split("").map((function(e){return e.charCodeAt(0)}))),n=t.Biscuit.from(r),(c=new t.Verifier).addResource(e.state.resource_verify_example),c.addOperation(e.state.restrict_verify_example),c.setTime(((new Date).getTime()/1e3).toFixed(0)),l=t.rule("check_right",[{variable:0},{variable:1}],[{name:"resource",ids:[{symbol:"ambient"},{variable:0}]},{name:"operation",ids:[{symbol:"ambient"},{variable:1}]},{name:"right",ids:[{symbol:"authority"},{variable:0},{variable:1}]}]),c.addCaveat(l),i=t.KeyPair.fromBytes(H(e.state.privateKey_own_verification));try{c.verify(i.publicKey(),n),e.setState({result_verification_example:"OK"})}catch(s){e.setState({result_verification_example:"FAILED"})}a.next=22;break;case 19:a.prev=19,a.t0=a.catch(0),e.setState({result_verification_example:a.t0.message});case 22:case"end":return a.stop()}}),a,null,[[0,19]])})))},"Verify Your Token"),n.a.createElement("div",{className:"verification"},this.state.result_verification_example)))),n.a.createElement("br",null),n.a.createElement("h2",{className:"mr-5 ml-5"},"Set Your Own Token Verification "),n.a.createElement("br",null),n.a.createElement("div",{className:"ml-5"},"You can add opeartion,resource,fact or rule to be verified on your token"),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h3",null,"Add Ambient Data"))))),n.a.createElement("div",{className:"ml-5 mr-5"},"The ambient data is the information on the resources , operations the verifier provide before the verification "),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"Resource")),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea2",type:"text",value:this.state.resource_verify,placeholder:"car1",onChange:this.handleChange4,rows:"1"}))),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{className:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"Operation to verify on the resource")),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",type:"text",value:this.state.restrict_verify,placeholder:"drive",onChange:this.handleChange5,rows:"1"})))),n.a.createElement("br",null)),n.a.createElement("div",{className:"container-fluid mt-10",onChange:this.handleChange},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("label",{className:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"Fact")))),n.a.createElement("div",{className:"ml-5"},"Ambient facts can only be provided by the verifier, and are represented by the #ambient symbol as the first element of a fact. They indicate data related to the operation the token is authorizing"),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 mr-2 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"fact name ")),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{variant:"outlined",type:"text",value:this.state.verification_fact_head_name,className:"verification_fact_head_name form-control",id:"verification-fact-head-name",row:"1"}))),n.a.createElement(G,{rules:l,type:"text"}),n.a.createElement("div",{className:"col-0 mr-3 "},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement(w.a,{onClick:this.addFactVerification},n.a.createElement(S.a,null))))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-0 mr-1 "},n.a.createElement("button",{className:"col-12",onClick:Object(b.a)(h.a.mark((function a(){var t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.prev=0,e.setState({verification_fact_adding_message:""}),t=0;case 3:if(!(t<e.state.verification_fact_head_parameters.length)){a.next=9;break}if(""!==e.state.verification_fact_head_name&&""!==e.state.verification_fact_head_parameters[t].param&&""!==e.state.verification_fact_head_parameters[t].type){a.next=6;break}throw SyntaxError("Incomplete data: all fields must be filled out");case 6:t++,a.next=3;break;case 9:0===e.state.verification_fact_counter?(console.log("number of facts",e.state.verification_number_of_added_fact),e.setState({verification_facts:[{fact_head_parameters:e.state.verification_fact_head_parameters,fact_head_name:e.state.verification_fact_head_name}]})):e.setState((function(a){return{verification_facts:[].concat(Object(p.a)(a.verification_facts),[{fact_head_parameters:e.state.verification_fact_head_parameters,fact_head_name:e.state.verification_fact_head_name}])}})),e.setState({verification_fact_adding_message:"Your new fact has been added"}),e.setState({verification_fact_counter:e.state.verification_fact_counter+1}),e.setState({verification_fact_head_name:"",verification_fact_head_parameters:[{param:"",type:""}]}),a.next=18;break;case 15:a.prev=15,a.t0=a.catch(0),e.setState({verification_fact_adding_message:a.t0.message});case 18:case"end":return a.stop()}}),a,null,[[0,15]])})))},"add fact")),n.a.createElement("div",{className:"col-2 ml-3"},n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({verification_fact_head_name:"",verification_fact_head_parameters:[{param:"",type:""}],verification_fact_adding_message:""});case 1:case"end":return a.stop()}}),a)})))},"Reset fact")))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-2 mr-2 ml-5"},n.a.createElement("div",{id:"verification_fact_adding_result"},this.state.verification_fact_adding_message))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-5 ml-5"},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h3",null,"Add a Rule to verify"))))),n.a.createElement("div",{className:"ml-5"},"Add a rule to verify on your token . for example if we set this rule : ",n.a.createElement("pre",null,'\n                            rule(\n                                "right",//head name\n                                [{ symbol: "right" }],//head parameter\n                                [\n                                    {\n                                        name: "right",//ids name\n                                        ids: [{ symbol: "authority" }, { string:room1 }, { symbol: "open" }]//ids paramter\n                                    }\n                                ]\n                            )\n\n                            ')," The verifier will verify if the token holder has the authority right to open the room1"),n.a.createElement("br",null),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h4",null,"Header")),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 mr-2 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"head name ")),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{variant:"outlined",type:"text",value:this.state.verification_caveat_head_name,className:"verification_caveat_head_name form-control",id:"head-name",row:"1"}))),n.a.createElement(W,{rules:c}),n.a.createElement("div",{className:"col-0 mr-3 "},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement(w.a,{onClick:this.addCaveatVerification},n.a.createElement(S.a,null))))),n.a.createElement("div",{className:"ml-5"},n.a.createElement("h4",null,"Body")),n.a.createElement("h5",{className:"ml-5"},this.state.caveat_hidden_msg_predicate),n.a.createElement(O,{predicates:this.state.caveat_body}),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1 ml-5"},n.a.createElement("div",{className:"row"},n.a.createElement("label",null,"pid".concat(this.state.caveat_idx," "))),n.a.createElement("div",{className:"row"},n.a.createElement("textarea",{id:"outlined-basic",label:"ids",variant:"outlined",type:"text",value:this.state.verification_caveat_ids_name,className:"verification_caveat_ids_name form-control"}))),n.a.createElement(U,{rules:i,caveat_idx:this.state.caveat_idx}),n.a.createElement("div",{className:"col-0 mr-2"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("h3",null,n.a.createElement(w.a,{onClick:this.addCaveat1Verification},n.a.createElement(S.a,null))))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.addPredicate_caveat},"add predicate"),n.a.createElement("div",null,this.state.caveat_predicate_adding))),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("br",null)," ",n.a.createElement("br",null)),n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:this.delPredicate_caveat},"Delete last predicate"),n.a.createElement("div",null,this.state.caveat_predicate_deleting)))),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-0 "},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:a.prev=0,e.setState({verification_caveat_adding_message:""}),t=0;case 3:if(!(t<e.state.verification_caveat_head_parameter.length)){a.next=9;break}if(""!==e.state.verification_caveat_head_name&&""!==e.state.verification_caveat_head_parameter[t].param&&""!==e.state.verification_caveat_head_parameter[t].type){a.next=6;break}throw SyntaxError("Incomplete data: all fields must be filled out");case 6:t++,a.next=3;break;case 9:if(0!==e.state.caveat_body.length){a.next=11;break}throw SyntaxError("You must at least add one predicate !");case 11:return 0===e.state.verification_caveat_counter?e.setState({verification_caveats:[{head_parameter:e.state.verification_caveat_head_parameter,head_name:e.state.verification_caveat_head_name,body:e.state.caveat_body}]}):e.setState((function(a){return{verification_caveats:[].concat(Object(p.a)(a.verification_caveats),[{head_parameter:e.state.verification_caveat_head_parameter,ids_parameter:e.state.verification_caveat_ids_parameter,head_name:e.state.verification_caveat_head_name,ids_name:e.state.verification_caveat_ids_name}])}})),e.setState({verification_caveat_adding_message:"Your new rule has been added"}),e.setState({verification_caveat_counter:e.state.verification_caveat_counter+1}),e.setState({verification_caveat_head_name:"",verification_caveat_head_parameter:[{param:"",type:""}],caveat_predicate_adding:"",body:[],caveat_body:[],caveat_idx:1}),a.next=17,new Promise((function(e){return setTimeout(e,2e3)}));case 17:console.log(e.state.verification_caveats),a.next=23;break;case 20:a.prev=20,a.t0=a.catch(0),e.setState({verification_caveat_adding_message:a.t0.message});case 23:case"end":return a.stop()}}),a,null,[[0,20]])})))},"add rule")),n.a.createElement("div",{className:"col-1 ml-1"},n.a.createElement("div",{className:"row"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({verification_caveat_head_parameter:[{param:"",type:""}],verification_caveat_ids_parameter:[{param:"",type:""}],verification_caveat_head_name:"",verification_caveat_ids_name:"",verification_caveat_adding_message:"",caveat_body:[],caveat_predicate_adding:"",caveat_idx:1,caveat_hidden_msg_predicate:"",caveat_predicate_deleting:""});case 1:case"end":return a.stop()}}),a)})))},"Reset rule")))),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-1"}),n.a.createElement("div",{className:"col-2 mr-2 "},n.a.createElement("div",{id:"verification_caveat_adding_result"},this.state.verification_caveat_adding_message))),n.a.createElement("br",null)," ",n.a.createElement("br",null),n.a.createElement("br",null),n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-4"}),n.a.createElement("div",{className:"col-2 ml-5"},n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var r,n,c,l,i,s,o,m,d,_,u,v,f,b,E,g,y,x,N,w,k;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(a.prev=0,""!==e.state.valueEncoded_verification){a.next=5;break}throw SyntaxError("You must enter the token to verify");case 5:if(""!==e.state.privateKey_own_verification){a.next=7;break}throw SyntaxError("You must enter your private key");case 7:if(r=new Uint8Array(atob(e.state.valueEncoded_verification).split("").map((function(e){return e.charCodeAt(0)}))),n=t.Biscuit.from(r),(c=new t.Verifier).addResource(e.state.resource_verify),c.addOperation(e.state.restrict_verify),console.log("caveat counter :",e.state.verification_caveat_counter),e.state.verification_caveat_counter>0)for(l=0;l<e.state.verification_caveats.length;l++){for(console.log("step {}",l),i=Object(p.a)(e.state.verification_caveats[l].head_parameter),s=[],o=0;o<i.length;o++)"variable"===i[o].type?s=[].concat(Object(p.a)(s),[{variable:parseInt(i[o].param)}]):"string"===i[o].type?s=[].concat(Object(p.a)(s),[{string:i[o].param}]):"symbol"===i[o].type?s=[].concat(Object(p.a)(s),[{symbol:i[o].param}]):"integer"===i[o].type?s=[].concat(Object(p.a)(s),[{integer:parseInt(i[o].param)}]):"date"===i[o].type&&(s=[].concat(Object(p.a)(s),[{date:Date.parse(i[o].param)}]));for(m=Object(p.a)(e.state.verification_caveats[l].body),d=[],_=0;_<m.length;_++){for(u=m[_].ids_name,v=Object(p.a)(m[_].caveat_ids_parameter),f=[],b=0;b<v.length;b++)"variable"===v[b].type?f=[].concat(Object(p.a)(f),[{variable:parseInt(v[b].param)}]):"string"===v[b].type?f=[].concat(Object(p.a)(f),[{string:v[b].param}]):"symbol"===v[b].type?f=[].concat(Object(p.a)(f),[{symbol:v[b].param}]):"integer"===v[b].type?f=[].concat(Object(p.a)(f),[{integer:parseInt(v[b].param)}]):"date"===v[b].type&&(f=[].concat(Object(p.a)(f),[{date:Date.parse(v[b].param)}]));d=[].concat(Object(p.a)(d),[{name:u,ids:f}])}console.log("body_for_rule",d),E=t.rule(e.state.verification_caveats[l].head_name,s,d),c.addCaveat(E)}if(console.log("fact counter :",e.state.verification_fact_counter),e.state.verification_fact_counter>0)for(console.log("verification facts",e.state.verification_facts),g=0;g<e.state.verification_facts.length;g++){for(y=Object(p.a)(e.state.verification_facts[g].fact_head_parameters),x=[],N=0;N<y.length;N++)"variable"===y[N].type?x=[].concat(Object(p.a)(x),[{variable:parseInt(y[N].param)}]):"string"===y[N].type?x=[].concat(Object(p.a)(x),[{string:y[N].param}]):"symbol"===y[N].type?x=[].concat(Object(p.a)(x),[{symbol:y[N].param}]):"integer"===y[N].type?x=[].concat(Object(p.a)(x),[{integer:parseInt(y[N].param)}]):"date"===y[N].type&&(x=[].concat(Object(p.a)(x),[{date:Date.parse(y[N].param)}]));console.log("fact parameter for verification",x),w=t.fact(e.state.verification_facts[g].fact_head_name,x),c.addFact(w)}k=t.KeyPair.fromBytes(H(e.state.privateKey_own_verification));try{c.verify(k.publicKey(),n),e.setState({result_verification:"OK"})}catch(h){e.setState({result_verification:"Failed"})}a.next=23;break;case 20:a.prev=20,a.t0=a.catch(0),e.setState({result_verification:a.t0.message});case 23:case"end":return a.stop()}}),a,null,[[0,20]])})))},"Verify Your Token"),n.a.createElement("div",{className:"verification"},this.state.result_verification))))))}}]),r}(n.a.Component),q=t(80);var J=function(){return n.a.createElement("footer",{className:"page-footer footer font-small  pt-4 bg-blue"},n.a.createElement("div",{className:"container text-center text-md-left"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-6 mt-md-0 mt-3"},n.a.createElement("h5",{className:"text-uppercase"},"Biscuitsec playground"),n.a.createElement("p",null,"Supported by ",n.a.createElement("a",{style:{color:"#D1A26A"},href:"https://acert.io"},"acert.io")," ")),n.a.createElement("hr",{className:"clearfix w-100 d-md-none pb-3"}),n.a.createElement("div",{className:"col-md-3 mb-md-0 mb-3"}),n.a.createElement("div",{className:"col-md-1 mb-md-0 mb-3 ml-5"},n.a.createElement("ul",{className:"list-unstyled"},n.a.createElement("li",null,n.a.createElement("div",{className:"col-md-1 mb-md-0 mb-3"},n.a.createElement("ul",{className:"list-unstyled"},n.a.createElement("li",null,n.a.createElement("div",null,n.a.createElement(q.SocialIcon,{network:"twitter",url:"https://twitter.com/acertHQ"})))))))))),n.a.createElement("div",{className:"footer-copyright text-center py-3"},"\xa9 2020 Copyright",n.a.createElement("a",{href:"to_be_defined"}," biscuitsec")))},z=function(e){return e.reduce((function(e,a){return e+a.toString(16).padStart(2,"0")}),"")},Q=function(e){return new Uint8Array(e.match(/.{1,2}/g).map((function(e){return parseInt(e,16)})))},$=function(e){Object(o.a)(r,e);var a=Object(m.a)(r);function r(){var e;return Object(i.a)(this,r),(e=a.call(this)).loadWasm=Object(b.a)(h.a.mark((function a(){var r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,a.next=3,t.e(0).then(t.bind(null,285));case 3:r=a.sent,e.setState({wasm:r}),a.next=10;break;case 7:a.prev=7,a.t0=a.catch(0),console.error("Unexpected error in loadWasm. [Message: ".concat(a.t0.message,"]"));case 10:case"end":return a.stop()}}),a,null,[[0,7]])}))),e.handleChangee=function(a){var t=e.state.token,r=btoa(String.fromCharCode.apply(String,Object(p.a)(t)));e.setState({valueEncoded:r,valueDecoded:a.target.value})},e.handleChange1=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({token:c.toVec(),valueEncoded:a.target.value,valueDecoded:c.print(),message_encoded:""})}catch(l){e.setState({valueEncoded:a.target.value}),e.setState({message_encoded:"Enter a valid token !"})}},e.handleChange_privateKey=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_privateKey:""});var n=new Uint8Array(32),c=new Uint8Array(32),l=Q(a.target.value),i=r.KeyPair.fromBytes(l),s=i.publicKey();i.toBytes(n),s.toBytes(c),e.setState({privateKey:z(n),publicKey:z(c)})}catch(o){e.setState({privateKey:a.target.value}),e.setState({message_privateKey:"enter a valid key !"})}},e.handleChangee_example=function(a){var t=e.state.token_example,r=btoa(String.fromCharCode.apply(String,Object(p.a)(t)));e.setState({valueEncoded_example:r,valueDecoded_example:a.target.value})},e.handleChange1_example=function(a){var t=e.state.wasm,r=void 0===t?{}:t;try{e.setState({message_encoded_example:""});var n=new Uint8Array(atob(a.target.value).split("").map((function(e){return e.charCodeAt(0)}))),c=r.Biscuit.from(n);e.setState({token_example:c.toVec(),valueEncoded_example:a.target.value,valueDecoded_example:c.print(),message_encoded_example:""})}catch(l){e.setState({valueEncoded_example:a.target.value}),e.setState({message_encoded_example:"Enter a valid token !"})}},e.handleChange2=function(a){e.setState({restrict:a.target.value})},e.handleChange3=function(a){e.setState({resource:a.target.value})},e.handleChange4=function(a){e.setState({resource_verify:a.target.value})},e.handleChange4_example=function(a){e.setState({resource_verify_example:a.target.value})},e.handleChange5_example=function(a){e.setState({restrict_verify_example:a.target.value})},e.handleChange5=function(a){e.setState({restrict_verify:a.target.value})},e.handleChange6=function(a){e.setState({seconds:a.target.value})},e.addPredicate_rule=function(){var a=Object(b.a)(h.a.mark((function a(t){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.setState({rule_predicate_adding:""}),a.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:if(0!==e.state.rule_body.length){a.next=9;break}return e.setState({rule_body:[{ids_name:e.state.ids_name,rule_ids_parameter:e.state.ids_parameter}],ids_name:"",ids_parameter:[{param:"",type:""}],rule_predicate_adding:"your predicate has been added",rule_idx:e.state.rule_idx+1}),a.next=7,new Promise((function(e){return setTimeout(e,1e3)}));case 7:a.next=10;break;case 9:e.setState((function(a){return{rule_body:[].concat(Object(p.a)(a.rule_body),[{ids_name:e.state.ids_name,rule_ids_parameter:e.state.ids_parameter}]),ids_name:"",ids_parameter:[{param:"",type:""}],rule_predicate_adding:"your predicate has been added",rule_idx:e.state.rule_idx+1}}));case 10:return a.next=12,new Promise((function(e){return setTimeout(e,1e3)}));case 12:console.log("rule body",e.state.rule_body),console.log("rule_idx",e.state.rule_idx);case 14:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.addPredicate_caveat=function(){var a=Object(b.a)(h.a.mark((function a(t){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return e.setState({caveat_predicate_adding:""}),a.next=3,new Promise((function(e){return setTimeout(e,500)}));case 3:if(0!==e.state.caveat_body.length){a.next=9;break}return e.setState({caveat_body:[{ids_name:e.state.caveat_ids_name,caveat_ids_parameter:e.state.caveat_ids_parameter}],caveat_ids_name:"",caveat_ids_parameter:[{param:"",type:""}],caveat_predicate_adding:"your predicate has been added",caveat_idx:e.state.caveat_idx+1}),a.next=7,new Promise((function(e){return setTimeout(e,1e3)}));case 7:a.next=10;break;case 9:e.setState((function(a){return{caveat_body:[].concat(Object(p.a)(a.caveat_body),[{ids_name:e.state.caveat_ids_name,caveat_ids_parameter:e.state.caveat_ids_parameter}]),caveat_ids_name:"",caveat_ids_parameter:[{param:"",type:""}],caveat_predicate_adding:"your predicate has been added",caveat_idx:e.state.caveat_idx+1}}));case 10:return a.next=12,new Promise((function(e){return setTimeout(e,1e3)}));case 12:console.log("caveat body",e.state.caveat_body);case 13:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.addFact=function(){var a=Object(b.a)(h.a.mark((function a(t){return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState((function(a){return{fact_head_parameters:[].concat(Object(p.a)(a.fact_head_parameters),[{param:"",type:""}]),number_of_added_fact:e.state.number_of_added_fact+1}}));case 1:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}(),e.addRule1_caveat=function(a){e.setState((function(a){return{caveat_ids_parameter:[].concat(Object(p.a)(a.caveat_ids_parameter),[{param:"",type:""}]),number_of_added_caveats_ids:e.state.number_of_added_caveats_ids+1}}))},e.addRule_caveat=function(a){e.setState((function(a){return{caveat_head_parameter:[].concat(Object(p.a)(a.caveat_head_parameter),[{param:"",type:""}]),number_of_added_caveats_head:e.state.number_of_added_caveats_head+1}}))},e.addRule1=function(a){e.setState((function(a){return{ids_parameter:[].concat(Object(p.a)(a.ids_parameter),[{param:"",type:""}]),number_of_added_rules_ids:e.state.number_of_added_rules_ids+1}}))},e.addRule=function(a){e.setState((function(a){return{head_parameter:[].concat(Object(p.a)(a.head_parameter),[{param:"",type:""}]),number_of_added_rules_head:e.state.number_of_added_rules_head+1}}))},e.state={token:[],token_example:[],token_verification:[],tokenToAttenuate:[],valueEncoded:"",valueDecoded:"",valueEncodedToAttenuate:"",valueDecodedToAttenuate:"",valueEncoded_example:"",valueEncoded_verification:"",valueDecoded_example:"",valueDecoded_verification:"",privateKey:"",publicKey:"",privateKey_own_verification:"",publicKey_own_verification:"",attenuation_publicKey:"",attenuation_privateKey:"",restrict:"",resource:"",expiration:"",restrict_verify:"",restrict_operation_message:"",resource_prefix_message:"",token_revocation_message:"",restrict_verify_example:"",resource_verify:"",resource_verify_example:"",seconds:"",result_verification:"",gen_err:"",gen_err_empty:"",gen_err_example:"",gen_err_attenuation:"",result_verification_example:"",message_encoded_verification:"",message_encoded_example:"",message_encoded_attenuation:"",message_encoded:"",message_privateKey:"",message_privateKey_own_verification:"",message_privateKey_attenuation:"",copied:!1},e}return Object(s.a)(r,[{key:"componentDidMount",value:function(){this.loadWasm()}},{key:"copy",value:function(){this.setState({copied:!0}),this.textArea.select(),document.execCommand("copy")}},{key:"render",value:function(){var e=this,a=this.state.wasm,r=void 0===a?{}:a,c=function(){var a=Q(e.state.privateKey);return r.KeyPair.fromBytes(a)},l=this.state.copied?"Copied":"Copy to clipboard";return n.a.createElement("div",null,n.a.createElement("div",{className:"container-fluid"},n.a.createElement("section",{className:"banner-biscuit mr-2"},n.a.createElement("div",{className:"container header"},n.a.createElement("br",null),n.a.createElement("a",{className:"logo",href:"/"},n.a.createElement("img",{src:t(279),alt:"logo"})),n.a.createElement("br",null),n.a.createElement("a",{className:"logo",href:"/"},n.a.createElement("img",{src:t(280),alt:"logo"})),n.a.createElement("h1",null," playground "))),n.a.createElement("div",{className:"warning"},n.a.createElement("div",{className:"text-center"},n.a.createElement("strong",null,"Biscuitsec :"),"Learn how the biscuit token works by interacting with it. For developers, the code of the application is available on our github")),"                    ",n.a.createElement("h1",{className:"mr-5 text-center"},"Token Example "),n.a.createElement("br",null),n.a.createElement("h2",{className:"mr-5 ml-5"},"Root Keys Generation "),n.a.createElement("div",{className:"mr-5 ml-5"},"Biscuits use public key cryptography. You can either use an existing public/private keypair, or we'll generate one for you.",n.a.createElement("br",null)," Please note this site does not record neither the provided keys nor the generated tokens. "),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-12"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea2"},n.a.createElement("h5",null,"Public Key"))," ",n.a.createElement("small",null," press the button to generate your keys"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea2",type:"text",readOnly:!0,value:this.state.publicKey,rows:"2"}))),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"form-group brown-border-focus"},n.a.createElement("label",{className:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"Private Key")),n.a.createElement("small",null," if you wanna use your private key paste it here"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",type:"text",value:this.state.privateKey,onChange:this.handleChange_privateKey,rows:"2"})),n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var t,n,c,l;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({message_privateKey:""}),t=new Uint8Array(32),n=new Uint8Array(32),c=new r.KeyPair,l=c.publicKey(),c.toBytes(t),l.toBytes(n),e.setState({privateKey:z(t),publicKey:z(n)});case 8:case"end":return a.stop()}}),a)})))},"Generate keys"),n.a.createElement("div",null,this.state.message_privateKey)))),n.a.createElement("br",null),n.a.createElement("h2",{className:"ml-5"},"Predefined token "),n.a.createElement("div",{className:"ml-5"},"This predefined token illustrate an example of rental car agency management.",n.a.createElement("br",null)," To read the explanation and the code of this example click ",n.a.createElement("a",{href:"https://www.w3schools.com/"},"here")),n.a.createElement("br",null),n.a.createElement("div",{className:"container-fluid mt-10"},n.a.createElement("div",{className:"row"},n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"textarea-container"},n.a.createElement("label",null,n.a.createElement("h5",null,"ENCODED")),n.a.createElement("textarea",{className:"form-control",ref:function(a){return e.textArea=a},id:"exampleFormControlTextarea2",readOnly:!0,value:this.state.valueEncoded_example,onChange:this.handleChange1_example,rows:"15"}),n.a.createElement("a",{onClick:function(){return e.copy()}},l)),n.a.createElement("div",null,this.state.message_encoded_example)),n.a.createElement("div",{className:"col-md-5 ml-5"},n.a.createElement("div",{className:"textarea-container"},n.a.createElement("label",{htmlFor:"exampleFormControlTextarea1"},n.a.createElement("h5",null,"DECODED")),n.a.createElement("small",null," your result"),n.a.createElement("textarea",{className:"form-control",id:"exampleFormControlTextarea1",readOnly:!0,type:"text",value:this.state.valueDecoded_example,onChange:this.handleChangee_example,rows:"15"})),n.a.createElement("br",null),n.a.createElement("button",{onClick:Object(b.a)(h.a.mark((function a(){var t,n,l,i,s;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:e.setState({gen_err_example:""}),t=new r.Biscuit,n=r.fact("right",[r.string("car1"),r.symbol("drive")]),t.addAuthorityFact(n),n=r.fact("right",[{string:"car2"},{symbol:"drive"}]),t.addAuthorityFact(n),n=r.fact("right",[{string:"car3"},{symbol:"drive"}]),t.addAuthorityFact(n);try{l=t.build(c()),i=l.toVec(),s=btoa(String.fromCharCode.apply(String,Object(p.a)(i))),e.setState({token_example:l.toVec(),valueEncoded_example:s,valueDecoded_example:l.print()})}catch(o){e.setState({gen_err_example:"You must generate your keypair before generating your token !"})}case 9:case"end":return a.stop()}}),a)})))},"Basic rights token"),n.a.createElement("div",{id:"verification_result"},this.state.gen_err_example))))))}}]),r}(n.a.Component),X=function(e){Object(o.a)(t,e);var a=Object(m.a)(t);function t(){var e;Object(i.a)(this,t);for(var r=arguments.length,n=new Array(r),c=0;c<r;c++)n[c]=arguments[c];return(e=a.call.apply(a,[this].concat(n))).state={},e}return Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement("div",{className:"App"},n.a.createElement(v,null),n.a.createElement(d.b,{exact:!0,path:"/"},n.a.createElement(d.a,{to:"/start"})),n.a.createElement(d.b,{exact:!0,path:"/tokengen",component:A}),n.a.createElement(d.b,{exact:!0,path:"/start",component:$}),n.a.createElement(d.b,{exact:!0,path:"/tokenatt",component:V}),n.a.createElement(d.b,{exact:!0,path:"/tokenver",component:L}),n.a.createElement("br",null),n.a.createElement("br",null)," ",n.a.createElement("br",null),n.a.createElement(J,null))}}]),t}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));t(281),t(282),t(283);l.a.render(n.a.createElement(u.a,null,n.a.createElement(X,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[183,2,3]]]);
//# sourceMappingURL=main.0c1cfb4f.chunk.js.map